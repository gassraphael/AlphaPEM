<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Display modules - AlphaPEM</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Display modules";
        var mkdocs_page_input_path = "functions/modules/display_modules.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> AlphaPEM
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Functions</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../../GUI/">GUI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../main/">Main</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Calibration</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../calibration/experimental_values/">Experimental values</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../calibration/parameter_calibration/">Parameter calibration</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Configuration</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../configuration/current_densities/">Current densities</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../configuration/settings/">Settings</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Model</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../model/AlphaPEM/">AlphaPEM</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../model/auxiliaries/">Auxiliaries</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../model/cell_voltage/">Cell voltage</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../model/control/">Control</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../model/dif_eq/">Differentiel equations</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../model/flows/">Flows</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../model/heat_transfer/">Heat transfer</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" >Modules</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../auxiliaries_modules/">Auxiliaries modules</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../calibration_modules/">Calibration modules</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../dif_eq_modules/">Differential equations modules</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="#">Display modules</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../flows_modules/">Flows modules</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../GUI_modules/">GUI modules</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../heat_modules/">Heat modules</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../main_modules/">Main modules</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../settings_modules/">Settings modules</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../transitory_functions/">Transitory functions</a>
                </li>
    </ul>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../about/">About</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">AlphaPEM</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Functions</li>
          <li class="breadcrumb-item">Modules</li>
      <li class="breadcrumb-item active">Display modules</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="display-modules">Display modules</h1>


<div class="doc doc-object doc-module">



<a id="modules.display_modules"></a>
    <div class="doc doc-contents first">

        <p>This module is used to accurately plot the figures.</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.calculate_simulation_error" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_simulation_error</span><span class="p">(</span><span class="n">Ucell</span><span class="p">,</span> <span class="n">U_exp_t</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function calculates the simulation error between the simulated cell voltage and the experimental cell
voltage. It is calculated as the maximum relative difference between the two voltages (in %).</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>Ucell</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>Simulated cell voltage.</p>
              </div>
            </li>
            <li>
              <b><code>U_exp_t</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>Experimental cell voltage.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>float</code>
              –
              <div class="doc-md-description">
                <p>Simulation error between the simulated cell voltage and the experimental cell voltage (in %).</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_simulation_error</span><span class="p">(</span><span class="n">Ucell</span><span class="p">,</span> <span class="n">U_exp_t</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function calculates the simulation error between the simulated cell voltage and the experimental cell</span>
<span class="sd">    voltage. It is calculated as the maximum relative difference between the two voltages (in %).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Ucell : numpy.ndarray</span>
<span class="sd">        Simulated cell voltage.</span>
<span class="sd">    U_exp_t : numpy.ndarray</span>
<span class="sd">        Experimental cell voltage.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float</span>
<span class="sd">        Simulation error between the simulated cell voltage and the experimental cell voltage (in %).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Ucell</span> <span class="o">-</span> <span class="n">U_exp_t</span><span class="p">)</span> <span class="o">/</span> <span class="n">U_exp_t</span> <span class="o">*</span> <span class="mi">100</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># in %.</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.make_Fourier_transformation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_Fourier_transformation</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function calculates the Fourier transformation of both cell voltage and current density. It will be used to
display the Nyquist and Bode diagrams.
To generate it at each frequency change, the cell voltage and the current density are recorded. The time for which
these points are captured is determined using the following approach: at the beginning of each frequency change, a
delta_t_break_EIS time is observed to ensure the dynamic stability of the stack's variables. Subsequently, a
delta_t_measurement_EIS time is needed to record the cell voltage and the current density.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>variables</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Variables calculated by the solver. They correspond to the fuel cell internal states.</p>
              </div>
            </li>
            <li>
              <b><code>operating_inputs</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Operating inputs of the fuel cell.</p>
              </div>
            </li>
            <li>
              <b><code>parameters</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Parameters of the fuel cell model.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>dict</code>
              –
              <div class="doc-md-description">
                <p>Dictionary containing the Fourier transformation (FT) of the cell voltage and the current density, all amplitude
values of the cell voltage calculated by the FT, the amplitude of the cell voltage at the frequency of the
perturbation, all frequency values used vy the FT, the frequency of the perturbation, and the number of points
used in the FT.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_Fourier_transformation</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function calculates the Fourier transformation of both cell voltage and current density. It will be used to</span>
<span class="sd">    display the Nyquist and Bode diagrams.</span>
<span class="sd">    To generate it at each frequency change, the cell voltage and the current density are recorded. The time for which</span>
<span class="sd">    these points are captured is determined using the following approach: at the beginning of each frequency change, a</span>
<span class="sd">    delta_t_break_EIS time is observed to ensure the dynamic stability of the stack&#39;s variables. Subsequently, a</span>
<span class="sd">    delta_t_measurement_EIS time is needed to record the cell voltage and the current density.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variables : dict</span>
<span class="sd">        Variables calculated by the solver. They correspond to the fuel cell internal states.</span>
<span class="sd">    operating_inputs : dict</span>
<span class="sd">        Operating inputs of the fuel cell.</span>
<span class="sd">    parameters : dict</span>
<span class="sd">        Parameters of the fuel cell model.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        Dictionary containing the Fourier transformation (FT) of the cell voltage and the current density, all amplitude</span>
<span class="sd">        values of the cell voltage calculated by the FT, the amplitude of the cell voltage at the frequency of the</span>
<span class="sd">        perturbation, all frequency values used vy the FT, the frequency of the perturbation, and the number of points</span>
<span class="sd">        used in the FT.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extraction of the variables</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">Ucell_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Ucell&#39;</span><span class="p">])</span>
    <span class="c1"># Extraction of the operating inputs and the parameters</span>
    <span class="n">current_density</span> <span class="o">=</span> <span class="n">operating_inputs</span><span class="p">[</span><span class="s1">&#39;current_density&#39;</span><span class="p">]</span>
    <span class="n">t_EIS</span><span class="p">,</span> <span class="n">max_step</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;t_EIS&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;max_step&#39;</span><span class="p">]</span>

    <span class="c1"># Creation of ifc</span>
    <span class="n">ifc_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
        <span class="n">ifc_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_density</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">parameters</span><span class="p">)</span>

    <span class="c1"># Identify the areas where Ucell and ifc can be measured for the EIS: after equilibrium and at each frequency change</span>
    <span class="n">t0_EIS</span><span class="p">,</span> <span class="n">t_new_start_EIS</span><span class="p">,</span> <span class="n">tf_EIS</span><span class="p">,</span> <span class="n">delta_t_break_EIS</span><span class="p">,</span> <span class="n">delta_t_measurement_EIS</span> <span class="o">=</span> <span class="n">t_EIS</span>
    <span class="n">n_inf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">t_new_start_EIS</span> <span class="o">&lt;=</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># The number of frequency changes which has been mad so far.</span>
    <span class="n">Ucell_EIS_measured</span> <span class="o">=</span> <span class="n">Ucell_t</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">t</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_t_break_EIS</span><span class="p">[</span><span class="n">n_inf</span><span class="p">]))</span> <span class="o">&amp;</span>
                                          <span class="p">(</span><span class="n">t</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_t_break_EIS</span><span class="p">[</span><span class="n">n_inf</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_t_measurement_EIS</span><span class="p">[</span><span class="n">n_inf</span><span class="p">])))]</span>
    <span class="n">ifc_EIS_measured</span> <span class="o">=</span> <span class="n">ifc_t</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">t</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_t_break_EIS</span><span class="p">[</span><span class="n">n_inf</span><span class="p">]))</span> <span class="o">&amp;</span>
                                      <span class="p">(</span><span class="n">t</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_t_break_EIS</span><span class="p">[</span><span class="n">n_inf</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_t_measurement_EIS</span><span class="p">[</span><span class="n">n_inf</span><span class="p">])))]</span>

    <span class="c1"># Determination of the Fourier transformation</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">Ucell_EIS_measured</span><span class="o">.</span><span class="n">size</span>  <span class="c1"># Number of points used for the Fourier transformation</span>
    <span class="n">Ucell_Fourier</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">Ucell_EIS_measured</span><span class="p">)</span>  <span class="c1"># Ucell Fourier transformation</span>
    <span class="n">ifc_Fourier</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">ifc_EIS_measured</span><span class="p">)</span>  <span class="c1"># ifc Fourier transformation</span>
    <span class="n">A_period_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
        <span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Ucell_Fourier</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">N</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Ucell_Fourier</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span> <span class="o">//</span> <span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">N</span><span class="p">))</span>  <span class="c1"># Recovery of</span>
    <span class="c1">#                                                                             all amplitude values calculated by fft</span>
    <span class="n">A</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">A_period_t</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>  <span class="c1"># Amplitude at the frequency of the perturbation</span>
    <span class="n">freq_t</span> <span class="o">=</span> <span class="n">fftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">max_step</span><span class="p">)[:</span><span class="n">N</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span>  <span class="c1"># Recovery of all frequency values used by fft</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">freq_t</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">A_period_t</span> <span class="o">==</span> <span class="n">A</span><span class="p">)]</span>  <span class="c1"># Recovery of the studied frequency</span>

    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;Ucell_Fourier&#39;</span><span class="p">:</span> <span class="n">Ucell_Fourier</span><span class="p">,</span> <span class="s1">&#39;ifc_Fourier&#39;</span><span class="p">:</span> <span class="n">ifc_Fourier</span><span class="p">,</span> <span class="s1">&#39;A_period_t&#39;</span><span class="p">:</span> <span class="n">A_period_t</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="n">A</span><span class="p">,</span>
            <span class="s1">&#39;freq_t&#39;</span><span class="p">:</span> <span class="n">freq_t</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="n">f</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="n">N</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_Bode_amplitude_instructions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_Bode_amplitude_instructions</span><span class="p">(</span><span class="n">f_EIS</span><span class="p">,</span> <span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function adds the instructions for amplitude Bode plots according to the type_input to the ax object.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>type_fuel_cell</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Type of fuel cell configuration.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the instructions will be added.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_Bode_amplitude_instructions</span><span class="p">(</span><span class="n">f_EIS</span><span class="p">,</span> <span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function adds the instructions for amplitude Bode plots according to the type_input to the ax object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    type_fuel_cell : str</span>
<span class="sd">        Type of fuel cell configuration.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the instructions will be added.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Commun instructions</span>
    <span class="n">f_power_min_EIS</span><span class="p">,</span> <span class="n">f_power_max_EIS</span><span class="p">,</span> <span class="n">nb_f_EIS</span><span class="p">,</span> <span class="n">nb_points_EIS</span> <span class="o">=</span> <span class="n">f_EIS</span>  <span class="c1"># They are the frequency parameters for the EIS</span>
    <span class="c1">#                                                                    simulation.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span> <span class="c1"># set logarithmic scale for the x-axis</span>
    <span class="c1"># Configure the appearance of major and minor ticks</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># Adjust layout to prevent overlap between labels and the figure</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># Show the figure</span>

    <span class="c1"># For EH-31 fuel cell</span>
    <span class="k">if</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_1.5&quot;</span> <span class="ow">or</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.0&quot;</span> <span class="ow">or</span> \
            <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.25&quot;</span> <span class="ow">or</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.5&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">LogLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">numticks</span><span class="o">=</span><span class="n">f_power_max_EIS</span> <span class="o">-</span> <span class="n">f_power_min_EIS</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">LogLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">subs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="mf">.1</span><span class="p">,</span>
                                              <span class="n">numticks</span><span class="o">=</span><span class="p">(</span><span class="n">f_power_max_EIS</span> <span class="o">-</span> <span class="n">f_power_min_EIS</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">))))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">30</span> <span class="o">/</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">10</span><span class="o">**</span><span class="n">f_power_min_EIS</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="n">f_power_max_EIS</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_Bode_phase_instructions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_Bode_phase_instructions</span><span class="p">(</span><span class="n">f_EIS</span><span class="p">,</span> <span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function adds the instructions for phase Bode plots according to the type_input to the ax object.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>type_fuel_cell</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Type of fuel cell configuration.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the instructions will be added.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_Bode_phase_instructions</span><span class="p">(</span><span class="n">f_EIS</span><span class="p">,</span> <span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function adds the instructions for phase Bode plots according to the type_input to the ax object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    type_fuel_cell : str</span>
<span class="sd">        Type of fuel cell configuration.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the instructions will be added.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Commun instructions</span>
    <span class="n">f_power_min_EIS</span><span class="p">,</span> <span class="n">f_power_max_EIS</span><span class="p">,</span> <span class="n">nb_f_EIS</span><span class="p">,</span> <span class="n">nb_points_EIS</span> <span class="o">=</span> <span class="n">f_EIS</span>  <span class="c1"># They are the frequency parameters for the EIS</span>
    <span class="c1">#                                                                    simulation.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>  <span class="c1"># set logarithmic scale for the x-axis</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="o">.</span><span class="n">yaxis_inverted</span><span class="p">():</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>  <span class="c1"># Invert the y-axis</span>
    <span class="c1"># Configure the appearance of major and minor ticks</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># Adjust layout to prevent overlap between labels and the figure</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># Show the figure</span>

    <span class="c1"># For EH-31 fuel cell</span>
    <span class="k">if</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_1.5&quot;</span> <span class="ow">or</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.0&quot;</span> <span class="ow">or</span> \
            <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.25&quot;</span> <span class="ow">or</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.5&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">LogLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">numticks</span> <span class="o">=</span> <span class="n">f_power_max_EIS</span><span class="o">-</span><span class="n">f_power_min_EIS</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">LogLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">subs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="mf">.1</span><span class="p">,</span>
                                              <span class="n">numticks</span> <span class="o">=</span> <span class="p">(</span><span class="n">f_power_max_EIS</span><span class="o">-</span><span class="n">f_power_min_EIS</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">))))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">5</span> <span class="o">/</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">10</span><span class="o">**</span><span class="n">f_power_min_EIS</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="n">f_power_max_EIS</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_C_H2" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_C_H2</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function plots the hydrogen concentration at different spatial localisations, as a function of time.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>variables</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Variables calculated by the solver. They correspond to the fuel cell internal states.</p>
              </div>
            </li>
            <li>
              <b><code>n_gdl</code></b>
                  (<code>int</code>)
              –
              <div class="doc-md-description">
                <p>Number of model nodes placed inside each GDL.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the hydrogen concentration will be plotted.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_C_H2</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function plots the hydrogen concentration at different spatial localisations, as a function of time.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variables : dict</span>
<span class="sd">        Variables calculated by the solver. They correspond to the fuel cell internal states.</span>
<span class="sd">    n_gdl : int</span>
<span class="sd">        Number of model nodes placed inside each GDL.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the hydrogen concentration will be plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extraction of the parameters</span>
    <span class="n">n_gdl</span><span class="p">,</span> <span class="n">type_current</span><span class="p">,</span> <span class="n">type_plot</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;n_gdl&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_current&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_plot&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;step_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_step&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization_for_cali&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_for_cali_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola_cali&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Extraction of the variables</span>
    <span class="k">if</span> <span class="n">type_plot</span> <span class="o">==</span> <span class="s2">&quot;fixed&quot;</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">delta_t_ini</span>  <span class="c1"># select the time after 0.9*delta_t_ini</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># type_plot == &quot;dynamic&quot;</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">C_H2_agc_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;C_H2_agc&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">C_H2_agdl_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;C_H2_agdl_</span><span class="si">{</span><span class="n">n_gdl</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">C_H2_acl_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;C_H2_acl&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>

    <span class="c1"># Plot the hydrogen concentration at different spatial localisations: C_H2</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">C_H2_agc_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">C_H2_agdl_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">C_H2_acl_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{C_{H_</span><span class="si">{2}</span><span class="s1">,agc}}$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathregular{C_{H_</span><span class="si">{2}</span><span class="s1">,agdl}}$&#39;</span><span class="p">,</span>
               <span class="sa">r</span><span class="s1">&#39;$\mathregular{C_{H_</span><span class="si">{2}</span><span class="s1">,acl}}$&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Time}</span><span class="s1">$ $\mathbf</span><span class="si">{t}</span><span class="s1">$ $\mathbf{\left( s \right)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Hydrogen}</span><span class="s1">$ $\mathbf</span><span class="si">{concentration}</span><span class="s1">$ $\mathbf{C_{H_</span><span class="si">{2}</span><span class="s1">}}$ $\mathbf{\left( mol.m^{-3} \right)}$&#39;</span><span class="p">,</span>
                  <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1"># Plot instructions</span>
    <span class="n">plot_general_instructions</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_C_N2" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_C_N2</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function plots the nitrogen concentration as a function of time.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>variables</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Variables calculated by the solver. They correspond to the fuel cell internal states.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the nitrogen concentration will be plotted.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_C_N2</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function plots the nitrogen concentration as a function of time.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variables : dict</span>
<span class="sd">        Variables calculated by the solver. They correspond to the fuel cell internal states.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the nitrogen concentration will be plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extraction of the parameters</span>
    <span class="n">type_current</span><span class="p">,</span> <span class="n">type_plot</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_current&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_plot&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;step_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_step&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization_for_cali&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_for_cali_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola_cali&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Extraction of the variables</span>
    <span class="k">if</span> <span class="n">type_plot</span> <span class="o">==</span> <span class="s2">&quot;fixed&quot;</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">delta_t_ini</span>  <span class="c1"># select the time after 0.9*delta_t_ini</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># type_plot == &quot;dynamic&quot;</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">C_N2_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;C_N2&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>

    <span class="c1"># Plot C_N2</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">C_N2_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{C_{N_</span><span class="si">{2}</span><span class="s1">}}$&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Time}</span><span class="s1">$ $\mathbf</span><span class="si">{t}</span><span class="s1">$ $\mathbf{\left( s \right)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Nitrogen}</span><span class="s1">$ $\mathbf</span><span class="si">{concentration}</span><span class="s1">$ $\mathbf{C_{N_</span><span class="si">{2}</span><span class="s1">}}$ $\mathbf{\left( mol.m^{-3} \right)}$&#39;</span><span class="p">,</span>
                  <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1"># Plot instructions</span>
    <span class="n">plot_general_instructions</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_C_O2" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_C_O2</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function plots the oxygen concentration at different spatial localisations, as a function of time.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>variables</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Variables calculated by the solver. They correspond to the fuel cell internal states.</p>
              </div>
            </li>
            <li>
              <b><code>n_gdl</code></b>
                  (<code>int</code>)
              –
              <div class="doc-md-description">
                <p>Number of model nodes placed inside each GDL.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the oxygen concentration will be plotted.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_C_O2</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function plots the oxygen concentration at different spatial localisations, as a function of time.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variables : dict</span>
<span class="sd">        Variables calculated by the solver. They correspond to the fuel cell internal states.</span>
<span class="sd">    n_gdl : int</span>
<span class="sd">        Number of model nodes placed inside each GDL.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the oxygen concentration will be plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extraction of the parameters</span>
    <span class="n">n_gdl</span><span class="p">,</span> <span class="n">type_current</span><span class="p">,</span> <span class="n">type_plot</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;n_gdl&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_current&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_plot&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;step_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_step&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization_for_cali&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_for_cali_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola_cali&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Extraction of the variables</span>
    <span class="k">if</span> <span class="n">type_plot</span> <span class="o">==</span> <span class="s2">&quot;fixed&quot;</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">delta_t_ini</span>  <span class="c1"># select the time after 0.9*delta_t_ini</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># type_plot == &quot;dynamic&quot;</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">C_O2_ccl_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;C_O2_ccl&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">C_O2_cgdl_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;C_O2_cgdl_</span><span class="si">{</span><span class="n">n_gdl</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">C_O2_cgc_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;C_O2_cgc&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>

    <span class="c1"># Plot the oxygen concentration at different spatial localisations: C_O2</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">C_O2_ccl_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">C_O2_cgdl_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">C_O2_cgc_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{C_{O_</span><span class="si">{2}</span><span class="s1">,ccl}}$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathregular{C_{O_</span><span class="si">{2}</span><span class="s1">,cgdl}}$&#39;</span><span class="p">,</span>
               <span class="sa">r</span><span class="s1">&#39;$\mathregular{C_{O_</span><span class="si">{2}</span><span class="s1">,cgc}}$&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Time}</span><span class="s1">$ $\mathbf</span><span class="si">{t}</span><span class="s1">$ $\mathbf{\left( s \right)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Oxygen}</span><span class="s1">$ $\mathbf</span><span class="si">{concentration}</span><span class="s1">$ $\mathbf{C_{O_</span><span class="si">{2}</span><span class="s1">}}$ $\mathbf{\left( mol.m^{-3} \right)}$&#39;</span><span class="p">,</span>
                  <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1"># Plot instructions</span>
    <span class="n">plot_general_instructions</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_C_v" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_C_v</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function plots the vapor concentrations at different spatial localisations, as a function of time.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>variables</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Variables calculated by the solver. They correspond to the fuel cell internal states.</p>
              </div>
            </li>
            <li>
              <b><code>n_gdl</code></b>
                  (<code>int</code>)
              –
              <div class="doc-md-description">
                <p>Number of model nodes placed inside each GDL.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the vapor concentration will be plotted.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_C_v</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function plots the vapor concentrations at different spatial localisations, as a function of time.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variables : dict</span>
<span class="sd">        Variables calculated by the solver. They correspond to the fuel cell internal states.</span>
<span class="sd">    n_gdl : int</span>
<span class="sd">        Number of model nodes placed inside each GDL.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the vapor concentration will be plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extraction of the parameter</span>
    <span class="n">n_gdl</span><span class="p">,</span> <span class="n">type_current</span><span class="p">,</span> <span class="n">type_plot</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;n_gdl&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_current&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_plot&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;step_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_step&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization_for_cali&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_for_cali_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola_cali&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Extraction of the variables</span>
    <span class="k">if</span> <span class="n">type_plot</span> <span class="o">==</span> <span class="s2">&quot;fixed&quot;</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">delta_t_ini</span>  <span class="c1"># select the time after 0.9*delta_t_ini</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># type_plot == &quot;dynamic&quot;</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">C_v_agc_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;C_v_agc&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">C_v_agdl_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;C_v_agdl_</span><span class="si">{</span><span class="n">n_gdl</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">C_v_acl_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;C_v_acl&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">C_v_ccl_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;C_v_ccl&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">C_v_cgdl_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;C_v_cgdl_</span><span class="si">{</span><span class="n">n_gdl</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">C_v_cgc_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;C_v_cgc&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">T_ccl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;T_ccl&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>

    <span class="c1"># Plot the vapor concentrations at different spatial localisations Cv</span>
    <span class="n">C_v_sat_ccl_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">C_v_sat</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">T_ccl</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">C_v_agc_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">C_v_agdl_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">C_v_acl_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">C_v_ccl_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">C_v_cgdl_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">C_v_cgc_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">C_v_sat_ccl_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{C_{v,agc}}$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathregular{C_{v,agdl}}$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathregular{C_{v,acl}}$&#39;</span><span class="p">,</span>
               <span class="sa">r</span><span class="s1">&#39;$\mathregular{C_{v,ccl}}$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathregular{C_{v,cgdl}}$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathregular{C_{v,cgc}}$&#39;</span><span class="p">,</span>
               <span class="sa">r</span><span class="s1">&#39;$\mathregular{C_{v,sat,ccl}}$&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Time}</span><span class="s1">$ $\mathbf</span><span class="si">{t}</span><span class="s1">$ $\mathbf{\left( s \right)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\mathbf</span><span class="si">{Vapor}</span><span class="s2">$ $\mathbf</span><span class="si">{concentration}</span><span class="s2">$ $\mathbf{C_</span><span class="si">{v}</span><span class="s2">}$ $\mathbf{\left( mol.m^{-3} \right)}$&quot;</span><span class="p">,</span>
                  <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1"># Plot instructions</span>
    <span class="n">plot_general_instructions</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_EIS_Nyquist_instructions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_EIS_Nyquist_instructions</span><span class="p">(</span><span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">f_Fourier</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function adds the instructions for EIS plots according to the type_input to the ax object.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>type_fuel_cell</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Type of fuel cell configuration.</p>
              </div>
            </li>
            <li>
              <b><code>f_Fourier</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>Frequency at which the EIS is simulated.</p>
              </div>
            </li>
            <li>
              <b><code>x</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>x-axis values for plotting the annotation.</p>
              </div>
            </li>
            <li>
              <b><code>y</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>y-axis values for plotting the annotation.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the instructions will be added.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_EIS_Nyquist_instructions</span><span class="p">(</span><span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">f_Fourier</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function adds the instructions for EIS plots according to the type_input to the ax object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    type_fuel_cell : str</span>
<span class="sd">        Type of fuel cell configuration.</span>
<span class="sd">    f_Fourier : numpy.ndarray</span>
<span class="sd">        Frequency at which the EIS is simulated.</span>
<span class="sd">    x : numpy.ndarray</span>
<span class="sd">        x-axis values for plotting the annotation.</span>
<span class="sd">    y : numpy.ndarray</span>
<span class="sd">        y-axis values for plotting the annotation.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the instructions will be added.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Commun instructions</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>  <span class="c1"># Set orthonormal axis.</span>
    <span class="c1"># Configure the appearance of major and minor ticks</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># Adjust layout to prevent overlap between labels and the figure</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># Show the figure</span>

    <span class="c1"># For EH-31 fuel cell</span>
    <span class="k">if</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_1.5&quot;</span> <span class="ow">or</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.0&quot;</span> <span class="ow">or</span> \
            <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.25&quot;</span> <span class="ow">or</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.5&quot;</span><span class="p">:</span>
        <span class="c1"># Double charge transfer</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">f_Fourier</span> <span class="o">&gt;=</span> <span class="mi">70</span> <span class="ow">and</span> <span class="n">f_Fourier</span> <span class="o">&lt;=</span> <span class="mi">80</span><span class="p">):</span>
            <span class="n">freq_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">f_Fourier</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; Hz&#39;</span>  <span class="c1"># Frequency annotation.</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">freq_str</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset points&quot;</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                        <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="c1"># Auxiliary system</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">f_Fourier</span> <span class="o">&gt;=</span> <span class="mf">0.14</span> <span class="ow">and</span> <span class="n">f_Fourier</span> <span class="o">&lt;=</span> <span class="mf">0.16</span><span class="p">):</span>
            <span class="n">freq_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">f_Fourier</span><span class="si">:</span><span class="s1">.2g</span><span class="si">}</span><span class="s1"> Hz&#39;</span>  <span class="c1"># Frequency annotation.</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">freq_str</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset points&quot;</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                        <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">f_Fourier</span> <span class="o">&gt;=</span> <span class="mf">1.2</span> <span class="ow">and</span> <span class="n">f_Fourier</span> <span class="o">&lt;=</span> <span class="mf">1.4</span><span class="p">):</span>
            <span class="n">freq_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">f_Fourier</span><span class="si">:</span><span class="s1">.2g</span><span class="si">}</span><span class="s1"> Hz&#39;</span>  <span class="c1"># Frequency annotation.</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">freq_str</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset points&quot;</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                        <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="c1"># Diffusion</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">f_Fourier</span> <span class="o">&gt;=</span> <span class="mf">0.015</span> <span class="ow">and</span> <span class="n">f_Fourier</span> <span class="o">&lt;=</span> <span class="mf">0.020</span><span class="p">):</span>
            <span class="n">freq_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">f_Fourier</span><span class="si">:</span><span class="s1">.2g</span><span class="si">}</span><span class="s1"> Hz&#39;</span>  <span class="c1"># Frequency annotation.</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">freq_str</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset points&quot;</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                        <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">f_Fourier</span> <span class="o">&gt;=</span> <span class="mf">0.9</span> <span class="ow">and</span> <span class="n">f_Fourier</span> <span class="o">&lt;=</span> <span class="mf">1.1</span><span class="p">):</span>
            <span class="n">freq_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">f_Fourier</span><span class="si">:</span><span class="s1">.2g</span><span class="si">}</span><span class="s1"> Hz&#39;</span>  <span class="c1"># Frequency annotation.</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">freq_str</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset points&quot;</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                        <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">f_Fourier</span> <span class="o">&gt;=</span> <span class="mi">70</span> <span class="ow">and</span> <span class="n">f_Fourier</span> <span class="o">&lt;=</span> <span class="mi">90</span><span class="p">):</span>
            <span class="n">freq_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">f_Fourier</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; Hz&#39;</span>  <span class="c1"># Frequency annotation.</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">freq_str</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset points&quot;</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                        <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">f_Fourier</span> <span class="o">&gt;=</span> <span class="mi">10000</span> <span class="ow">and</span> <span class="n">f_Fourier</span> <span class="o">&lt;=</span> <span class="mi">12000</span><span class="p">):</span>
            <span class="n">freq_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">f_Fourier</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; Hz&#39;</span>  <span class="c1"># Frequency annotation.</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">freq_str</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset points&quot;</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                        <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">20</span> <span class="o">/</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">10</span> <span class="o">/</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">55</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_EIS_curve_Bode_amplitude" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_EIS_curve_Bode_amplitude</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">Fourier_results</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function is used to plot the amplitude Bode diagram of the EIS curves.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>parameters</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Parameters of the fuel cell model.</p>
              </div>
            </li>
            <li>
              <b><code>Fourier_results</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Dictionary containing the Fourier transformation (FT) of the cell voltage and the current density, all amplitude
values of the cell voltage calculated by the FT, the amplitude of the cell voltage at the frequency of the
perturbation, all frequency values used vy the FT, the frequency of the perturbation, and the number of points
used in the FT.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the amplitude Bode diagram will be plotted.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_EIS_curve_Bode_amplitude</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">Fourier_results</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function is used to plot the amplitude Bode diagram of the EIS curves.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parameters : dict</span>
<span class="sd">        Parameters of the fuel cell model.</span>
<span class="sd">    Fourier_results : dict</span>
<span class="sd">        Dictionary containing the Fourier transformation (FT) of the cell voltage and the current density, all amplitude</span>
<span class="sd">        values of the cell voltage calculated by the FT, the amplitude of the cell voltage at the frequency of the</span>
<span class="sd">        perturbation, all frequency values used vy the FT, the frequency of the perturbation, and the number of points</span>
<span class="sd">        used in the FT.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the amplitude Bode diagram will be plotted.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extraction of the parameters</span>
    <span class="n">i_EIS</span><span class="p">,</span> <span class="n">ratio_EIS</span><span class="p">,</span> <span class="n">f_EIS</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;i_EIS&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;ratio_EIS&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;f_EIS&#39;</span><span class="p">]</span>
    <span class="n">type_fuel_cell</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_fuel_cell&#39;</span><span class="p">]</span>
    <span class="c1"># Extraction of the Fourier results</span>
    <span class="n">A</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">Fourier_results</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="n">Fourier_results</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span>

    <span class="c1"># Calculation of the impedance of the perturbation</span>
    <span class="n">Z0</span> <span class="o">=</span> <span class="n">A</span> <span class="o">/</span> <span class="p">(</span><span class="n">ratio_EIS</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">i_EIS</span><span class="p">))</span> <span class="o">*</span> <span class="mf">1e7</span>  <span class="c1"># in mΩ.cm². The sign of i is inverted to comply with the standards of EIS,</span>
    <span class="c1">#                                        which measure a device under load rather than a current source.</span>

    <span class="c1"># Plot the amplitude Bode diagram</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Z0</span><span class="p">),</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Amplitude Bode diagram&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Frequency}</span><span class="s1">$ $\mathbf{(Hz,}$ $\mathbf</span><span class="si">{logarithmic}</span><span class="s1">$ $\mathbf{scale)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Impedance}</span><span class="s1">$ $\mathbf</span><span class="si">{amplitude}</span><span class="s1">$ $\mathbf{(m\Omega.cm^</span><span class="si">{2}</span><span class="s1">)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1">#   Plot instructions</span>
    <span class="n">plot_Bode_amplitude_instructions</span><span class="p">(</span><span class="n">f_EIS</span><span class="p">,</span> <span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_EIS_curve_Bode_angle" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_EIS_curve_Bode_angle</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">Fourier_results</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function is used to plot the angle Bode diagram. It only works with an entry signal made with a cosinus
(not a sinus).</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>Fourier_results</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Dictionary containing the Fourier transformation (FT) of the cell voltage and the current density, all amplitude
values of the cell voltage calculated by the FT, the amplitude of the cell voltage at the frequency of the
perturbation, all frequency values used vy the FT, the frequency of the perturbation, and the number of points
used in the FT.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the angle Bode diagram will be plotted.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_EIS_curve_Bode_angle</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">Fourier_results</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function is used to plot the angle Bode diagram. It only works with an entry signal made with a cosinus</span>
<span class="sd">    (not a sinus).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Fourier_results : dict</span>
<span class="sd">        Dictionary containing the Fourier transformation (FT) of the cell voltage and the current density, all amplitude</span>
<span class="sd">        values of the cell voltage calculated by the FT, the amplitude of the cell voltage at the frequency of the</span>
<span class="sd">        perturbation, all frequency values used vy the FT, the frequency of the perturbation, and the number of points</span>
<span class="sd">        used in the FT.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the angle Bode diagram will be plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extraction of the parameters</span>
    <span class="n">f_EIS</span><span class="p">,</span> <span class="n">type_fuel_cell</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;f_EIS&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_fuel_cell&#39;</span><span class="p">]</span>
    <span class="c1"># Extraction of the Fourier results</span>
    <span class="n">Ucell_Fourier</span><span class="p">,</span> <span class="n">ifc_Fourier</span> <span class="o">=</span> <span class="n">Fourier_results</span><span class="p">[</span><span class="s1">&#39;Ucell_Fourier&#39;</span><span class="p">],</span> <span class="n">Fourier_results</span><span class="p">[</span><span class="s1">&#39;ifc_Fourier&#39;</span><span class="p">]</span>
    <span class="n">A_period_t</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">Fourier_results</span><span class="p">[</span><span class="s1">&#39;A_period_t&#39;</span><span class="p">],</span> <span class="n">Fourier_results</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="n">Fourier_results</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">],</span> <span class="n">Fourier_results</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span>

    <span class="c1"># Calculation of the dephasing values at the frequency of the perturbation</span>
    <span class="n">theta_U_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">Ucell_Fourier</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span> <span class="o">//</span> <span class="mi">2</span><span class="p">])</span>  <span class="c1"># Recovery of all dephasing values calculated by fft</span>
    <span class="n">theta_i_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">ifc_Fourier</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span> <span class="o">//</span> <span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>  <span class="c1"># Recovery of all dephasing values calculated by fft.</span>
    <span class="c1">#                                                    An angle of pi is added to comply with the standards of EIS,</span>
    <span class="c1">#                                                    which measure a device under load rather than a current source.</span>
    <span class="n">theta_U</span> <span class="o">=</span> <span class="n">theta_U_t</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">A_period_t</span> <span class="o">==</span> <span class="n">A</span><span class="p">)]</span>  <span class="c1"># Dephasing at the frequency of the perturbation</span>
    <span class="n">theta_i</span> <span class="o">=</span> <span class="n">theta_i_t</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">A_period_t</span> <span class="o">==</span> <span class="n">A</span><span class="p">)]</span>  <span class="c1"># Dephasing at the frequency of the perturbation</span>
    <span class="n">phi_U_i</span> <span class="o">=</span> <span class="p">((</span><span class="n">theta_U</span> <span class="o">-</span> <span class="n">theta_i</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span> <span class="c1"># Dephasing between Ucell and ifc with a value between 0 and 360</span>
    <span class="k">if</span> <span class="n">phi_U_i</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span>
        <span class="n">phi_U_i</span> <span class="o">-=</span> <span class="mi">360</span> <span class="c1"># To have a value between -180 and 180</span>

    <span class="c1"># Plot the angle Bode diagram</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">phi_U_i</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Angle Bode diagram&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Frequency}</span><span class="s1">$ $\mathbf{(Hz,}$ $\mathbf</span><span class="si">{logarithmic}</span><span class="s1">$ $\mathbf{scale)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Phase}</span><span class="s1">$ $\mathbf{(^\circ)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1">#   Plot instructions</span>
    <span class="n">plot_Bode_phase_instructions</span><span class="p">(</span><span class="n">f_EIS</span><span class="p">,</span> <span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_EIS_curve_Nyquist" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_EIS_curve_Nyquist</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">Fourier_results</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function is used to plot the Nyquist diagram of the EIS curves.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>parameters</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Parameters of the fuel cell model.</p>
              </div>
            </li>
            <li>
              <b><code>Fourier_results</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Dictionary containing the Fourier transformation (FT) of the cell voltage and the current density, all amplitude
values of the cell voltage calculated by the FT, the amplitude of the cell voltage at the frequency of the
perturbation, all frequency values used vy the FT, the frequency of the perturbation, and the number of points
used in the FT.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the Nyquist diagram will be plotted.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_EIS_curve_Nyquist</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">Fourier_results</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function is used to plot the Nyquist diagram of the EIS curves.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parameters : dict</span>
<span class="sd">        Parameters of the fuel cell model.</span>
<span class="sd">    Fourier_results : dict</span>
<span class="sd">        Dictionary containing the Fourier transformation (FT) of the cell voltage and the current density, all amplitude</span>
<span class="sd">        values of the cell voltage calculated by the FT, the amplitude of the cell voltage at the frequency of the</span>
<span class="sd">        perturbation, all frequency values used vy the FT, the frequency of the perturbation, and the number of points</span>
<span class="sd">        used in the FT.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the Nyquist diagram will be plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extraction of the parameters</span>
    <span class="n">i_EIS</span><span class="p">,</span> <span class="n">ratio_EIS</span><span class="p">,</span> <span class="n">type_fuel_cell</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;i_EIS&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;ratio_EIS&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_fuel_cell&#39;</span><span class="p">]</span>
    <span class="c1"># Extraction of the Fourier results</span>
    <span class="n">Ucell_Fourier</span><span class="p">,</span> <span class="n">ifc_Fourier</span> <span class="o">=</span> <span class="n">Fourier_results</span><span class="p">[</span><span class="s1">&#39;Ucell_Fourier&#39;</span><span class="p">],</span> <span class="n">Fourier_results</span><span class="p">[</span><span class="s1">&#39;ifc_Fourier&#39;</span><span class="p">]</span>
    <span class="n">f_Fourier</span> <span class="o">=</span> <span class="n">Fourier_results</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span>
    <span class="n">A_period_t</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="n">Fourier_results</span><span class="p">[</span><span class="s1">&#39;A_period_t&#39;</span><span class="p">],</span> <span class="n">Fourier_results</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="n">Fourier_results</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span>

    <span class="c1"># Calculation of the real and imaginary component of the impedance for each period</span>
    <span class="n">Z0</span> <span class="o">=</span> <span class="n">A</span> <span class="o">/</span> <span class="p">(</span><span class="n">ratio_EIS</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">i_EIS</span><span class="p">))</span> <span class="o">*</span> <span class="mf">1e7</span>  <span class="c1"># Impedance of the perturbation in mΩ.cm². The sign of i is inverted to</span>
    <span class="c1">#                  comply with the standards of EIS, which measure a device under load rather than a current source.</span>
    <span class="n">theta_U_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">Ucell_Fourier</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span> <span class="o">//</span> <span class="mi">2</span><span class="p">])</span>  <span class="c1"># Recovery of all dephasing values calculated by fft</span>
    <span class="n">theta_i_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">ifc_Fourier</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span> <span class="o">//</span> <span class="mi">2</span><span class="p">])</span>  <span class="c1"># Recovery of all dephasing values calculated by fft</span>
    <span class="n">theta_U</span> <span class="o">=</span> <span class="n">theta_U_t</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">A_period_t</span> <span class="o">==</span> <span class="n">A</span><span class="p">)]</span>  <span class="c1"># Dephasing at the frequency of the perturbation</span>
    <span class="n">theta_i</span> <span class="o">=</span> <span class="n">theta_i_t</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">A_period_t</span> <span class="o">==</span> <span class="n">A</span><span class="p">)]</span>  <span class="c1"># Dephasing at the frequency of the perturbation</span>
    <span class="n">Z_real</span> <span class="o">=</span> <span class="n">Z0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_U</span> <span class="o">-</span> <span class="n">theta_i</span><span class="p">)</span>  <span class="c1"># Real component of the impedance for each period</span>
    <span class="n">Z_imag</span> <span class="o">=</span> <span class="n">Z0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta_U</span> <span class="o">-</span> <span class="n">theta_i</span><span class="p">)</span>  <span class="c1"># Imaginary component of the impedance for each period</span>

    <span class="c1"># Plot the Nyquist diagram</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Z_real</span><span class="p">,</span> <span class="o">-</span><span class="n">Z_imag</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Nyquist diagram&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf{Z_</span><span class="si">{real}</span><span class="s1">}$ $\mathbf{(m\Omega.cm^</span><span class="si">{2}</span><span class="s1">)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf{-Z_</span><span class="si">{imag}</span><span class="s1">}$ $\mathbf{(m\Omega.cm^</span><span class="si">{2}</span><span class="s1">)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1">#       Plot instructions</span>
    <span class="n">plot_EIS_Nyquist_instructions</span><span class="p">(</span><span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">f_Fourier</span><span class="p">,</span> <span class="n">Z_real</span><span class="p">,</span> <span class="o">-</span><span class="n">Z_imag</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_EIS_curve_tests" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_EIS_curve_tests</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">Fourier_results</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function is used to test the accuracy of the EIS results. It compares the reconstructed Ucell_Fourier(t)
from the Fourier transformation with the current density ifc(t), and displays Ucell(t) given by the model with the
reconstructed Ucell_Fourier(t).</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>variables</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Variables calculated by the solver. They correspond to the fuel cell internal states.</p>
              </div>
            </li>
            <li>
              <b><code>operating_inputs</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Operating inputs of the fuel cell.</p>
              </div>
            </li>
            <li>
              <b><code>parameters</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Parameters of the fuel cell model.</p>
              </div>
            </li>
            <li>
              <b><code>Fourier_results</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Dictionary containing the Fourier transformation (FT) of the cell voltage and the current density, all amplitude
values of the cell voltage calculated by the FT, the amplitude of the cell voltage at the frequency of the
perturbation, all frequency values used vy the FT, the frequency of the perturbation, and the number of points
used in the FT.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_EIS_curve_tests</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">Fourier_results</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function is used to test the accuracy of the EIS results. It compares the reconstructed Ucell_Fourier(t)</span>
<span class="sd">    from the Fourier transformation with the current density ifc(t), and displays Ucell(t) given by the model with the</span>
<span class="sd">    reconstructed Ucell_Fourier(t).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variables : dict</span>
<span class="sd">        Variables calculated by the solver. They correspond to the fuel cell internal states.</span>
<span class="sd">    operating_inputs : dict</span>
<span class="sd">        Operating inputs of the fuel cell.</span>
<span class="sd">    parameters : dict</span>
<span class="sd">        Parameters of the fuel cell model.</span>
<span class="sd">    Fourier_results : dict</span>
<span class="sd">        Dictionary containing the Fourier transformation (FT) of the cell voltage and the current density, all amplitude</span>
<span class="sd">        values of the cell voltage calculated by the FT, the amplitude of the cell voltage at the frequency of the</span>
<span class="sd">        perturbation, all frequency values used vy the FT, the frequency of the perturbation, and the number of points</span>
<span class="sd">        used in the FT.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extraction of the variables</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">Ucell_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]),</span> <span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Ucell&#39;</span><span class="p">]</span>
    <span class="c1"># Extraction of the operating inputs and the parameters</span>
    <span class="n">current_density</span> <span class="o">=</span> <span class="n">operating_inputs</span><span class="p">[</span><span class="s1">&#39;current_density&#39;</span><span class="p">]</span>
    <span class="n">i_EIS</span><span class="p">,</span> <span class="n">ratio_EIS</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;i_EIS&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;ratio_EIS&#39;</span><span class="p">]</span>
    <span class="n">t_EIS</span><span class="p">,</span> <span class="n">f_EIS</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;t_EIS&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;f_EIS&#39;</span><span class="p">]</span>
    <span class="c1"># Extraction of the Fourier results</span>
    <span class="n">Ucell_Fourier</span><span class="p">,</span> <span class="n">ifc_Fourier</span> <span class="o">=</span> <span class="n">Fourier_results</span><span class="p">[</span><span class="s1">&#39;Ucell_Fourier&#39;</span><span class="p">],</span> <span class="n">Fourier_results</span><span class="p">[</span><span class="s1">&#39;ifc_Fourier&#39;</span><span class="p">]</span>
    <span class="n">A_period_t</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">Fourier_results</span><span class="p">[</span><span class="s1">&#39;A_period_t&#39;</span><span class="p">],</span> <span class="n">Fourier_results</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="n">Fourier_results</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">],</span> <span class="n">Fourier_results</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span>

    <span class="c1"># Reconstructed Ucell with a cosinus form, and comparison of its form with the current density one.</span>
    <span class="n">t0_EIS</span><span class="p">,</span> <span class="n">t_new_start_EIS</span><span class="p">,</span> <span class="n">tf_EIS</span><span class="p">,</span> <span class="n">delta_t_break_EIS</span><span class="p">,</span> <span class="n">delta_t_measurement_EIS</span> <span class="o">=</span> <span class="n">t_EIS</span>
    <span class="n">f_power_min_EIS</span><span class="p">,</span> <span class="n">f_power_max_EIS</span><span class="p">,</span> <span class="n">nb_f_EIS</span><span class="p">,</span> <span class="n">nb_points_EIS</span> <span class="o">=</span> <span class="n">f_EIS</span>
    <span class="n">n_inf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">t_new_start_EIS</span> <span class="o">&lt;=</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># The number of frequency changes which has been made.</span>
    <span class="n">f_current</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">f_power_min_EIS</span><span class="p">,</span> <span class="n">f_power_max_EIS</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">nb_f_EIS</span><span class="p">)</span>
    <span class="n">theta_U_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">Ucell_Fourier</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span> <span class="o">//</span> <span class="mi">2</span><span class="p">])</span>  <span class="c1"># Recovery of all dephasing values calculated by fft</span>
    <span class="n">theta_i_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">ifc_Fourier</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span> <span class="o">//</span> <span class="mi">2</span><span class="p">])</span>  <span class="c1"># Recovery of all dephasing values calculated by fft</span>
    <span class="n">theta_U</span> <span class="o">=</span> <span class="n">theta_U_t</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">A_period_t</span> <span class="o">==</span> <span class="n">A</span><span class="p">)]</span>  <span class="c1"># Dephasing at the frequency of the perturbation</span>
    <span class="n">theta_i</span> <span class="o">=</span> <span class="n">theta_i_t</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">A_period_t</span> <span class="o">==</span> <span class="n">A</span><span class="p">)]</span>  <span class="c1"># Dephasing at the frequency of the perturbation</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ucell:&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">A_period_t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="s1">&#39; + &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="s2">&quot; * np.cos(2*np.pi*&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="s2">&quot;*t + &quot;</span><span class="p">,</span>
          <span class="nb">round</span><span class="p">(</span><span class="n">theta_U</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="s2">&quot;). &quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Current:&quot;</span><span class="p">,</span> <span class="n">i_EIS</span><span class="p">,</span> <span class="s1">&#39; + &#39;</span><span class="p">,</span> <span class="n">ratio_EIS</span> <span class="o">*</span> <span class="n">i_EIS</span><span class="p">,</span> <span class="s2">&quot; * np.cos(2*np.pi*&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">f_current</span><span class="p">[</span><span class="n">n_inf</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="s2">&quot;*t + &quot;</span><span class="p">,</span>
          <span class="nb">round</span><span class="p">(</span><span class="n">theta_i</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="s2">&quot;). </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Display ifc(t)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1">#   Creation of ifc_t</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">ifc_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>  <span class="c1"># Conversion in A/cm²</span>
        <span class="n">ifc_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_density</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">parameters</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e4</span>
    <span class="c1">#   Plot of ifc_t</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ifc_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ifc&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Current density (A/cm²)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;The current density</span><span class="se">\n</span><span class="s1">behaviour over time&#39;</span><span class="p">)</span>

    <span class="c1"># Display Ucell(t) and compare it with the reconstructed Ucell_Fourier(t) from the Fourier transformation</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">Ucell_Fourier</span> <span class="o">=</span> <span class="n">A_period_t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">theta_U</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Ucell_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ucell&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Ucell_Fourier</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ucell_Fourier&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Cell voltage (V)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;The cell voltage</span><span class="se">\n</span><span class="s1">behaviour over time&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_J" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_J</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function plots the sorption and dissolved water flows as a function of time.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>variables</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Variables calculated by the solver. They correspond to the fuel cell internal states.</p>
              </div>
            </li>
            <li>
              <b><code>parameters</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Parameters of the fuel cell model.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the flows will be plotted.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_J</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function plots the sorption and dissolved water flows as a function of time.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variables : dict</span>
<span class="sd">        Variables calculated by the solver. They correspond to the fuel cell internal states.</span>
<span class="sd">    parameters : dict</span>
<span class="sd">        Parameters of the fuel cell model.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the flows will be plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Extraction of the operating inputs and the parameters</span>
    <span class="n">Hcl</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Hcl&#39;</span><span class="p">]</span>
    <span class="n">type_current</span><span class="p">,</span> <span class="n">type_plot</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_current&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_plot&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;step_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_step&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization_for_cali&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_for_cali_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola_cali&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Extraction of the variables</span>
    <span class="k">if</span> <span class="n">type_plot</span> <span class="o">==</span> <span class="s2">&quot;fixed&quot;</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">delta_t_ini</span>  <span class="c1"># select the time after 0.9*delta_t_ini</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># type_plot == &quot;dynamic&quot;</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">S_abs_acl_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;S_abs_acl&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">S_abs_ccl_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;S_abs_ccl&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">J_lambda_acl_mem_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;J_lambda_acl_mem&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">J_lambda_mem_ccl_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;J_lambda_mem_ccl&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>

    <span class="c1"># Plot the sorption and dissolved water flows: J</span>
    <span class="n">J_abs_acl</span><span class="p">,</span> <span class="n">J_abs_ccl</span> <span class="o">=</span> <span class="n">S_abs_acl_t</span> <span class="o">*</span> <span class="n">Hcl</span><span class="p">,</span> <span class="n">S_abs_ccl_t</span> <span class="o">*</span> <span class="n">Hcl</span>  <span class="c1"># Conversion in mol.m⁻².s⁻¹ for comparison</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">J_abs_acl</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">J_lambda_acl_mem_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">J_abs_ccl</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">J_lambda_mem_ccl_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{J_{abs,acl}}$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathregular{J_{\lambda,mem,acl}}$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathregular{J_{abs,ccl}}$&#39;</span><span class="p">,</span>
               <span class="sa">r</span><span class="s1">&#39;$\mathregular{J_{\lambda,mem,ccl}}$&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Time}</span><span class="s1">$ $\mathbf</span><span class="si">{t}</span><span class="s1">$ $\mathbf{\left( s \right)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Flows}</span><span class="s1">$ $\mathbf</span><span class="si">{J}</span><span class="s1">$ $\mathbf{\left( mol.m^{-2}.s^{-1} \right)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;scientific&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">scilimits</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

    <span class="c1"># Plot instructions</span>
    <span class="n">plot_general_instructions</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_P" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_P</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function plots the pressure at different spatial localisations as a function of time.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>variables</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Variables calculated by the solver. They correspond to the fuel cell internal states.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the pressure will be plotted.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_P</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function plots the pressure at different spatial localisations as a function of time.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variables : dict</span>
<span class="sd">        Variables calculated by the solver. They correspond to the fuel cell internal states.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the pressure will be plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extraction of the parameters</span>
    <span class="n">type_current</span><span class="p">,</span> <span class="n">type_plot</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_current&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_plot&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;step_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_step&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization_for_cali&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_for_cali_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola_cali&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Extraction of the variables</span>
    <span class="k">if</span> <span class="n">type_plot</span> <span class="o">==</span> <span class="s2">&quot;fixed&quot;</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">delta_t_ini</span>  <span class="c1"># select the time after 0.9*delta_t_ini</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># type_plot == &quot;dynamic&quot;</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">Pagc_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Pagc&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e5</span> <span class="c1"># Conversion in atm</span>
    <span class="n">Pcgc_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Pcgc&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e5</span> <span class="c1"># Conversion in atm</span>
    <span class="n">Pasm_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Pasm&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e5</span> <span class="c1"># Conversion in atm</span>
    <span class="n">Paem_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Paem&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e5</span> <span class="c1"># Conversion in atm</span>
    <span class="n">Pcsm_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Pcsm&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e5</span> <span class="c1"># Conversion in atm</span>
    <span class="n">Pcem_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Pcem&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e5</span> <span class="c1"># Conversion in atm</span>

    <span class="c1"># Plot the pressure at different spatial localisations: P</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Pagc_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Pcgc_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Pasm_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Paem_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Pcsm_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Pcem_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{P_</span><span class="si">{agc}</span><span class="s1">}$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathregular{P_</span><span class="si">{cgc}</span><span class="s1">}$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathregular{P_</span><span class="si">{asm}</span><span class="s1">}$&#39;</span><span class="p">,</span>
               <span class="sa">r</span><span class="s1">&#39;$\mathregular{P_</span><span class="si">{aem}</span><span class="s1">}$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathregular{P_</span><span class="si">{csm}</span><span class="s1">}$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathregular{P_</span><span class="si">{cem}</span><span class="s1">}$&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Time}</span><span class="s1">$ $\mathbf</span><span class="si">{t}</span><span class="s1">$ $\mathbf{\left( s \right)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Pressure}</span><span class="s1">$ $\mathbf</span><span class="si">{P}</span><span class="s1">$ $\mathbf{\left( bar \right)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;scientific&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">scilimits</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

    <span class="c1"># Plot instructions</span>
    <span class="n">plot_general_instructions</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_Phi_a" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_Phi_a</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function plots the humidity at the anode side, at different spatial localisations, as a function of time.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>variables</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Variables calculated by the solver. They correspond to the fuel cell internal states.</p>
              </div>
            </li>
            <li>
              <b><code>operating_inputs</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Operating inputs of the fuel cell.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the humidity will be plotted.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_Phi_a</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function plots the humidity at the anode side, at different spatial localisations, as a function of time.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variables : dict</span>
<span class="sd">        Variables calculated by the solver. They correspond to the fuel cell internal states.</span>
<span class="sd">    operating_inputs : dict</span>
<span class="sd">        Operating inputs of the fuel cell.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the humidity will be plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extraction of the operating inputs and parameters</span>
    <span class="n">Phi_a_des</span> <span class="o">=</span> <span class="n">operating_inputs</span><span class="p">[</span><span class="s1">&#39;Phi_a_des&#39;</span><span class="p">]</span>
    <span class="n">type_current</span><span class="p">,</span> <span class="n">type_plot</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_current&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_plot&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;step_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_step&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization_for_cali&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_for_cali_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola_cali&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Extraction of the variables</span>
    <span class="k">if</span> <span class="n">type_plot</span> <span class="o">==</span> <span class="s2">&quot;fixed&quot;</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">delta_t_ini</span>  <span class="c1"># select the time after 0.9*delta_t_ini</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># type_plot == &quot;dynamic&quot;</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">C_v_agc_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;C_v_agc&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">T_agc_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;T_agc&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">Phi_asm_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Phi_asm&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">Phi_aem_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Phi_aem&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>

    <span class="c1"># Calculate the humidity Phi</span>
    <span class="n">Phi_agc_t</span> <span class="o">=</span> <span class="n">C_v_agc_t</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T_agc_t</span> <span class="o">/</span> <span class="n">Psat</span><span class="p">(</span><span class="n">T_agc_t</span><span class="p">)</span>

    <span class="c1"># Plot the humidity at different spatial localisations: Phi</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Phi_agc_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{\Phi_</span><span class="si">{agc}</span><span class="s1">}$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Phi_asm_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{\Phi_</span><span class="si">{asm}</span><span class="s1">}$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Phi_aem_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{\Phi_</span><span class="si">{aem}</span><span class="s1">}$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Phi_a_des</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{\Phi_{a,des}}$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center right&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.67</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Time}</span><span class="s1">$ $\mathbf</span><span class="si">{t}</span><span class="s1">$ $\mathbf{\left( s \right)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Humidity}</span><span class="s1">$ $\mathbf</span><span class="si">{at}</span><span class="s1">$ $\mathbf</span><span class="si">{the}</span><span class="s1">$ $\mathbf</span><span class="si">{anode}</span><span class="s1">$ $\mathbf</span><span class="si">{side}</span><span class="s1">$ $\mathbf{\Phi}$&#39;</span><span class="p">,</span>
                  <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1"># Plot instructions</span>
    <span class="n">plot_general_instructions</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_Phi_c" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_Phi_c</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function plots the humidity, at the cathode side, at different spatial localisations as a function of time.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>ax</code></b>
              –
              <div class="doc-md-description">
                <p>Variables calculated by the solver. They correspond to the fuel cell internal states.</p>
              </div>
            </li>
            <li>
              <b><code>operating_inputs</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Operating inputs of the fuel cell.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the humidity will be plotted.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_Phi_c</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function plots the humidity, at the cathode side, at different spatial localisations as a function of time.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax.plot(t, np.array([Phi_a_des]*len(t)), color=&#39;black&#39;, label=r&#39;$\mathregular{\Phi_{a,des}}$&#39;)</span>
<span class="sd">        Variables calculated by the solver. They correspond to the fuel cell internal states.</span>
<span class="sd">    operating_inputs : dict</span>
<span class="sd">        Operating inputs of the fuel cell.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the humidity will be plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extraction of the operating inputs and parameters</span>
    <span class="n">Phi_c_des</span> <span class="o">=</span> <span class="n">operating_inputs</span><span class="p">[</span><span class="s1">&#39;Phi_c_des&#39;</span><span class="p">]</span>
    <span class="n">type_current</span><span class="p">,</span> <span class="n">type_plot</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_current&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_plot&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;step_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_step&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization_for_cali&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_for_cali_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola_cali&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Extraction of the variables</span>
    <span class="k">if</span> <span class="n">type_plot</span> <span class="o">==</span> <span class="s2">&quot;fixed&quot;</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">delta_t_ini</span>  <span class="c1"># select the time after 0.9*delta_t_ini</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># type_plot == &quot;dynamic&quot;</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">C_v_cgc_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;C_v_cgc&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">T_cgc_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;T_cgc&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">Phi_csm_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Phi_csm&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">Phi_cem_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Phi_cem&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>

    <span class="c1"># Calculate the humidity Phi</span>
    <span class="n">Phi_cgc_t</span> <span class="o">=</span> <span class="n">C_v_cgc_t</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T_cgc_t</span> <span class="o">/</span> <span class="n">Psat</span><span class="p">(</span><span class="n">T_cgc_t</span><span class="p">)</span>

    <span class="c1"># Plot the humidity at different spatial localisations: Phi</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Phi_cgc_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{\Phi_</span><span class="si">{cgc}</span><span class="s1">}$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Phi_csm_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{\Phi_</span><span class="si">{csm}</span><span class="s1">}$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Phi_cem_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{\Phi_</span><span class="si">{cem}</span><span class="s1">}$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Phi_c_des</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{\Phi_{c,des}}$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Time}</span><span class="s1">$ $\mathbf</span><span class="si">{t}</span><span class="s1">$ $\mathbf{\left( s \right)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Humidity}</span><span class="s1">$ $\mathbf</span><span class="si">{at}</span><span class="s1">$ $\mathbf</span><span class="si">{the}</span><span class="s1">$ $\mathbf</span><span class="si">{cathode}</span><span class="s1">$ $\mathbf</span><span class="si">{side}</span><span class="s1">$ $\mathbf{\Phi}$&#39;</span><span class="p">,</span>
                  <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1"># Plot instructions</span>
    <span class="n">plot_general_instructions</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_Phi_des" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_Phi_des</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function plots the controlled or uncontrolled desired humidity at the anode and cathode as a function of the
current density.</p>
<p>Parameters
ax.plot(t, np.array([Phi_c_des]*len(t)), color='black', label=r'$\mathregular{\Phi_{c,des}}$')
variables : dict
    Variables calculated by the solver. They correspond to the fuel cell internal states.
operating_inputs : dict
    Operating inputs of the fuel cell.
parameters : dict
    Parameters of the fuel cell model.
ax : matplotlib.axes.Axes
    Axes on which the humidity will be plotted.</p>

            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_Phi_des</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function plots the controlled or uncontrolled desired humidity at the anode and cathode as a function of the</span>
<span class="sd">    current density.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ax.plot(t, np.array([Phi_c_des]*len(t)), color=&#39;black&#39;, label=r&#39;$\mathregular{\Phi_{c,des}}$&#39;)</span>
<span class="sd">    variables : dict</span>
<span class="sd">        Variables calculated by the solver. They correspond to the fuel cell internal states.</span>
<span class="sd">    operating_inputs : dict</span>
<span class="sd">        Operating inputs of the fuel cell.</span>
<span class="sd">    parameters : dict</span>
<span class="sd">        Parameters of the fuel cell model.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the humidity will be plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extraction of the operating inputs and the parameters</span>
    <span class="n">current_density</span> <span class="o">=</span> <span class="n">operating_inputs</span><span class="p">[</span><span class="s1">&#39;current_density&#39;</span><span class="p">]</span>
    <span class="n">pola_current_parameters</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_parameters&#39;</span><span class="p">]</span>
    <span class="n">type_current</span><span class="p">,</span> <span class="n">type_plot</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_current&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_plot&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;step_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_step&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization_for_cali&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_for_cali_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola_cali&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Extraction of the variables</span>
    <span class="k">if</span> <span class="n">type_plot</span> <span class="o">==</span> <span class="s2">&quot;fixed&quot;</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">delta_t_ini</span>  <span class="c1"># select the time after 0.9*delta_t_ini</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># type_plot == &quot;dynamic&quot;</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_control&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Phi_des&quot;</span><span class="p">:</span>
        <span class="n">Phi_a_des_t</span> <span class="o">=</span> <span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Phi_a_des&#39;</span><span class="p">][</span><span class="n">mask</span><span class="p">]</span>
        <span class="n">Phi_c_des_t</span> <span class="o">=</span> <span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Phi_c_des&#39;</span><span class="p">][</span><span class="n">mask</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Controlled}</span><span class="s1">$ $\mathbf</span><span class="si">{inlet}</span><span class="s1">$ $\mathbf</span><span class="si">{humidity}</span><span class="s1">$  $\mathbf{\Phi_</span><span class="si">{des}</span><span class="s1">}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Phi_a_des_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">operating_inputs</span><span class="p">[</span><span class="s1">&#39;Phi_a_des&#39;</span><span class="p">]]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
        <span class="n">Phi_c_des_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">operating_inputs</span><span class="p">[</span><span class="s1">&#39;Phi_c_des&#39;</span><span class="p">]]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Uncontrolled}</span><span class="s1">$ $\mathbf</span><span class="si">{inlet}</span><span class="s1">$ $\mathbf</span><span class="si">{humidity}</span><span class="s1">$ $\mathbf{\Phi_</span><span class="si">{des}</span><span class="s1">}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1"># Plot Phi_des</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">ifc_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>  <span class="c1"># Creation of ifc_t</span>
        <span class="n">ifc_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_density</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">parameters</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e4</span>  <span class="c1"># Conversion in A/cm²</span>

    <span class="c1"># Recovery of the internal states from the model after each stack stabilisation</span>
    <span class="n">delta_t_ini_pola</span> <span class="o">=</span> <span class="n">pola_current_parameters</span><span class="p">[</span><span class="s1">&#39;delta_t_ini_pola&#39;</span><span class="p">]</span>
    <span class="n">delta_t_load_pola</span> <span class="o">=</span> <span class="n">pola_current_parameters</span><span class="p">[</span><span class="s1">&#39;delta_t_load_pola&#39;</span><span class="p">]</span>
    <span class="n">delta_t_break_pola</span> <span class="o">=</span> <span class="n">pola_current_parameters</span><span class="p">[</span><span class="s1">&#39;delta_t_break_pola&#39;</span><span class="p">]</span>
    <span class="n">nb_loads</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pola_current_parameters</span><span class="p">[</span><span class="s1">&#39;i_max_pola&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">pola_current_parameters</span><span class="p">[</span><span class="s1">&#39;delta_i_pola&#39;</span><span class="p">])</span>  <span class="c1"># Number of loads</span>
    <span class="n">ifc_discretized_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nb_loads</span><span class="p">)</span>
    <span class="n">Phi_a_des_discretized_t</span><span class="p">,</span> <span class="n">Phi_c_des_discretized_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nb_loads</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nb_loads</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_loads</span><span class="p">):</span>
        <span class="n">t_load</span> <span class="o">=</span> <span class="n">delta_t_ini_pola</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">delta_t_load_pola</span> <span class="o">+</span> <span class="n">delta_t_break_pola</span><span class="p">)</span>  <span class="c1"># time for measurement</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">t_load</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>  <span class="c1"># the corresponding index</span>
        <span class="n">ifc_discretized_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ifc_t</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>  <span class="c1"># the last value at the end of each load</span>
        <span class="n">Phi_a_des_discretized_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Phi_a_des_t</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>  <span class="c1"># the last value at the end of each load</span>
        <span class="n">Phi_c_des_discretized_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Phi_c_des_t</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>  <span class="c1"># the last value at the end of each load</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ifc_discretized_t</span><span class="p">,</span> <span class="n">Phi_c_des_discretized_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{\Phi_{c,des}}$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Current}</span><span class="s1">$ $\mathbf</span><span class="si">{density}</span><span class="s1">$ $\mathbf{i_</span><span class="si">{fc}</span><span class="s1">}$ $\mathbf{\left( A.cm^{-2} \right)}$&#39;</span><span class="p">,</span>
                  <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_auxiliary&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;forced-convective_cathode_with_flow-through_anode&quot;</span> <span class="ow">or</span> \
       <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_auxiliary&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;no_auxiliary&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ifc_discretized_t</span><span class="p">,</span> <span class="n">Phi_a_des_discretized_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{\Phi_{a,des}}$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{\Phi_{a,des}}$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathregular{\Phi_{c,des}}$&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{\Phi_{c,des}}$&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

    <span class="c1"># Plot instructions</span>
    <span class="n">plot_general_instructions</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_T" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_T</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function plots the vapor concentrations at different spatial localisations, as a function of time.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>variables</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Variables calculated by the solver. They correspond to the fuel cell internal states.</p>
              </div>
            </li>
            <li>
              <b><code>operating_inputs</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Operating inputs of the fuel cell.</p>
              </div>
            </li>
            <li>
              <b><code>n_gdl</code></b>
                  (<code>int</code>)
              –
              <div class="doc-md-description">
                <p>Number of model nodes placed inside each GDL.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the vapor concentration will be plotted.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_T</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function plots the vapor concentrations at different spatial localisations, as a function of time.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variables : dict</span>
<span class="sd">        Variables calculated by the solver. They correspond to the fuel cell internal states.</span>
<span class="sd">    operating_inputs : dict</span>
<span class="sd">        Operating inputs of the fuel cell.</span>
<span class="sd">    n_gdl : int</span>
<span class="sd">        Number of model nodes placed inside each GDL.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the vapor concentration will be plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extraction of the operating inputs and parameters</span>
    <span class="n">T_des</span> <span class="o">=</span> <span class="n">operating_inputs</span><span class="p">[</span><span class="s1">&#39;T_des&#39;</span><span class="p">]</span>
    <span class="n">n_gdl</span><span class="p">,</span> <span class="n">type_current</span><span class="p">,</span> <span class="n">type_plot</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;n_gdl&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_current&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_plot&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;step_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_step&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization_for_cali&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_for_cali_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola_cali&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Extraction of the variables and the operating inputs</span>
    <span class="k">if</span> <span class="n">type_plot</span> <span class="o">==</span> <span class="s2">&quot;fixed&quot;</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">delta_t_ini</span>  <span class="c1"># select the time after 0.9*delta_t_ini</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># type_plot == &quot;dynamic&quot;</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">T_agc_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;T_agc&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span> <span class="o">-</span> <span class="mf">273.15</span> <span class="c1"># Conversion in °C.</span>
    <span class="n">T_agdl_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;T_agdl_</span><span class="si">{</span><span class="n">n_gdl</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span> <span class="o">-</span> <span class="mf">273.15</span> <span class="c1"># Conversion in °C.</span>
    <span class="n">T_acl_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;T_acl&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span> <span class="o">-</span> <span class="mf">273.15</span> <span class="c1"># Conversion in °C.</span>
    <span class="n">T_mem_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;T_mem&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span> <span class="o">-</span> <span class="mf">273.15</span> <span class="c1"># Conversion in °C.</span>
    <span class="n">T_ccl_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;T_ccl&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span> <span class="o">-</span> <span class="mf">273.15</span> <span class="c1"># Conversion in °C.</span>
    <span class="n">T_cgdl_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;T_cgdl_</span><span class="si">{</span><span class="n">n_gdl</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span> <span class="o">-</span> <span class="mf">273.15</span> <span class="c1"># Conversion in °C.</span>
    <span class="n">T_cgc_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;T_cgc&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span> <span class="o">-</span> <span class="mf">273.15</span> <span class="c1"># Conversion in °C.</span>

    <span class="c1"># Plot the temperature at different spatial localisations</span>
    <span class="n">T_des_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">T_des</span> <span class="o">-</span> <span class="mf">273.15</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">T_agc_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">T_agdl_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">T_acl_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">T_mem_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">T_ccl_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">T_cgdl_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">T_cgc_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">T_des_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{T_</span><span class="si">{agc}</span><span class="s1">}$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathregular{T_</span><span class="si">{agdl}</span><span class="s1">}$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathregular{T_</span><span class="si">{acl}</span><span class="s1">}$&#39;</span><span class="p">,</span>
               <span class="sa">r</span><span class="s1">&#39;$\mathregular{T_</span><span class="si">{mem}</span><span class="s1">}$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathregular{T_</span><span class="si">{ccl}</span><span class="s1">}$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathregular{T_</span><span class="si">{cgdl}</span><span class="s1">}$&#39;</span><span class="p">,</span>
               <span class="sa">r</span><span class="s1">&#39;$\mathregular{T_</span><span class="si">{cgc}</span><span class="s1">}$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathregular{T_</span><span class="si">{des}</span><span class="s1">}$&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Time}</span><span class="s1">$ $\mathbf</span><span class="si">{t}</span><span class="s1">$ $\mathbf{\left( s \right)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\mathbf</span><span class="si">{Temperature}</span><span class="s2">$ $\mathbf</span><span class="si">{T}</span><span class="s2">$ $\mathbf{\left( °C \right)}$&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1"># Plot instructions</span>
    <span class="n">plot_general_instructions</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_Ucell" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_Ucell</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function plots the cell voltage as a function of time.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>variables</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Variables calculated by the solver. They correspond to the fuel cell internal states.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the cell voltage will be plotted.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_Ucell</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function plots the cell voltage as a function of time.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variables : dict</span>
<span class="sd">        Variables calculated by the solver. They correspond to the fuel cell internal states.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the cell voltage will be plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extraction of the parameters</span>
    <span class="n">type_current</span><span class="p">,</span> <span class="n">type_plot</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_current&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_plot&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;step_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_step&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization_for_cali&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_for_cali_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola_cali&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Extraction of the variables</span>
    <span class="k">if</span> <span class="n">type_plot</span> <span class="o">==</span> <span class="s2">&quot;fixed&quot;</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">delta_t_ini</span>  <span class="c1"># select the time after 0.9*delta_t_ini</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># type_plot == &quot;dynamic&quot;</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">Ucell_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Ucell&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>

    <span class="c1"># Plot the cell voltage: Ucell</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Ucell_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{U_</span><span class="si">{cell}</span><span class="s1">}$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Time}</span><span class="s1">$ $\mathbf</span><span class="si">{t}</span><span class="s1">$ $\mathbf{\left( s \right)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Cell}</span><span class="s1">$ $\mathbf</span><span class="si">{voltage}</span><span class="s1">$ $\mathbf{U_</span><span class="si">{cell}</span><span class="s1">}$ $\mathbf{\left( V \right)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{U_</span><span class="si">{cell}</span><span class="s1">}$&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

    <span class="c1"># Plot instructions</span>
    <span class="n">plot_general_instructions</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_cell_efficiency" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_cell_efficiency</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function plots the fuel cell efficiency eta_fc as a function of the current density.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>variables</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Variables calculated by the solver. They correspond to the fuel cell internal states.</p>
              </div>
            </li>
            <li>
              <b><code>operating_inputs</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Operating inputs of the fuel cell.</p>
              </div>
            </li>
            <li>
              <b><code>parameters</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Parameters of the fuel cell model.</p>
              </div>
            </li>
            <li>
              <b><code>n</code></b>
                  (<code>int</code>)
              –
              <div class="doc-md-description">
                <p>Number of points used to plot the fuel cell efficiency.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the fuel cell efficiency will be plotted.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_cell_efficiency</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function plots the fuel cell efficiency eta_fc as a function of the current density.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variables : dict</span>
<span class="sd">        Variables calculated by the solver. They correspond to the fuel cell internal states.</span>
<span class="sd">    operating_inputs : dict</span>
<span class="sd">        Operating inputs of the fuel cell.</span>
<span class="sd">    parameters : dict</span>
<span class="sd">        Parameters of the fuel cell model.</span>
<span class="sd">    n : int</span>
<span class="sd">        Number of points used to plot the fuel cell efficiency.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the fuel cell efficiency will be plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extraction of the variables</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">Ucell_t</span><span class="p">,</span> <span class="n">lambda_mem_t</span> <span class="o">=</span> <span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Ucell&#39;</span><span class="p">],</span> <span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lambda_mem&#39;</span><span class="p">]</span>
    <span class="n">C_H2_acl_t</span><span class="p">,</span> <span class="n">C_O2_ccl_t</span> <span class="o">=</span> <span class="n">variables</span><span class="p">[</span><span class="s1">&#39;C_H2_acl&#39;</span><span class="p">],</span> <span class="n">variables</span><span class="p">[</span><span class="s1">&#39;C_O2_ccl&#39;</span><span class="p">]</span>
    <span class="n">T_acl_t</span><span class="p">,</span> <span class="n">T_mem_t</span><span class="p">,</span> <span class="n">T_ccl_t</span> <span class="o">=</span> <span class="n">variables</span><span class="p">[</span><span class="s1">&#39;T_acl&#39;</span><span class="p">],</span> <span class="n">variables</span><span class="p">[</span><span class="s1">&#39;T_mem&#39;</span><span class="p">],</span> <span class="n">variables</span><span class="p">[</span><span class="s1">&#39;T_ccl&#39;</span><span class="p">]</span>
    <span class="c1"># Extraction of the operating inputs and the parameters</span>
    <span class="n">current_density</span> <span class="o">=</span> <span class="n">operating_inputs</span><span class="p">[</span><span class="s1">&#39;current_density&#39;</span><span class="p">]</span>
    <span class="n">Hmem</span><span class="p">,</span> <span class="n">Hcl</span><span class="p">,</span> <span class="n">kappa_co</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Hmem&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Hcl&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;kappa_co&#39;</span><span class="p">]</span>
    <span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">type_current</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_fuel_cell&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_current&#39;</span><span class="p">]</span>
    <span class="n">type_auxiliary</span><span class="p">,</span> <span class="n">type_control</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_auxiliary&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_control&#39;</span><span class="p">]</span>

    <span class="c1"># Creation of the fuel cell efficiency: eta_fc</span>
    <span class="n">ifc_t</span><span class="p">,</span> <span class="n">Pfc_t</span><span class="p">,</span> <span class="n">eta_fc_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">ifc_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_density</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">parameters</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e4</span>  <span class="c1"># Conversion in A/cm²</span>
        <span class="n">Pfc_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ucell_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">ifc_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">Ueq</span> <span class="o">=</span> <span class="n">E0</span> <span class="o">-</span> <span class="mf">8.5e-4</span> <span class="o">*</span> <span class="p">(</span><span class="n">T_ccl_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mf">298.15</span><span class="p">)</span> <span class="o">+</span> \
              <span class="n">R</span> <span class="o">*</span> <span class="n">T_ccl_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">F</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T_acl_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">C_H2_acl_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">Pref</span><span class="p">)</span> <span class="o">+</span>
                                          <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T_ccl_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">C_O2_ccl_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">Pref</span><span class="p">))</span>
        <span class="n">T_acl_mem_ccl</span> <span class="o">=</span> <span class="n">average</span><span class="p">([</span><span class="n">T_acl_t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">T_mem_t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">T_ccl_t</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                                   <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="n">Hcl</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Hcl</span> <span class="o">+</span> <span class="n">Hmem</span><span class="p">),</span> <span class="n">Hmem</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Hcl</span> <span class="o">+</span> <span class="n">Hmem</span><span class="p">),</span> <span class="n">Hcl</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Hcl</span> <span class="o">+</span> <span class="n">Hmem</span><span class="p">)])</span>
        <span class="n">i_H2</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T_acl_mem_ccl</span> <span class="o">/</span> <span class="n">Hmem</span> <span class="o">*</span> <span class="n">C_H2_acl_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">k_H2</span><span class="p">(</span><span class="n">lambda_mem_t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">T_mem_t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">kappa_co</span><span class="p">)</span>
        <span class="n">i_O2</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T_acl_mem_ccl</span> <span class="o">/</span> <span class="n">Hmem</span> <span class="o">*</span> <span class="n">C_O2_ccl_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">k_O2</span><span class="p">(</span><span class="n">lambda_mem_t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">T_mem_t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">kappa_co</span><span class="p">)</span>
        <span class="n">i_n</span> <span class="o">=</span> <span class="p">(</span><span class="n">i_H2</span> <span class="o">+</span> <span class="n">i_O2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e4</span>  <span class="c1"># Conversion in A/cm²</span>
        <span class="n">eta_fc_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pfc_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">Ueq</span> <span class="o">*</span> <span class="p">(</span><span class="n">ifc_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">i_n</span><span class="p">))</span>

    <span class="c1"># Plot of the fuel cell efficiency: eta_fc</span>
    <span class="n">plot_specific_line</span><span class="p">(</span><span class="n">ifc_t</span><span class="p">,</span> <span class="n">eta_fc_t</span><span class="p">,</span> <span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">type_current</span><span class="p">,</span> <span class="n">type_auxiliary</span><span class="p">,</span> <span class="n">type_control</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Current}</span><span class="s1">$ $\mathbf</span><span class="si">{density}</span><span class="s1">$ $\mathbf{i_</span><span class="si">{fc}</span><span class="s1">}$ $\mathbf{\left( A.cm^{-2} \right)}$&#39;</span><span class="p">,</span>
                  <span class="n">labelpad</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Fuel}</span><span class="s1">$ $\mathbf</span><span class="si">{cell}</span><span class="s1">$ $\mathbf</span><span class="si">{efficiency}</span><span class="s1">$ $\mathbf{\eta_</span><span class="si">{fc}</span><span class="s1">}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

    <span class="c1"># Plot instructions</span>
    <span class="n">plot_general_instructions</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_general_instructions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_general_instructions</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">set_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function adds the common instructions for all the plots displayed by AlphaPEM to the ax object.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the instructions will be added.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_general_instructions</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">set_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function adds the common instructions for all the plots displayed by AlphaPEM to the ax object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the instructions will be added.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the current x-axis and y-axis limits</span>
    <span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
    <span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
    <span class="c1"># Calculate the major step for the x-axis and y-axis ticks</span>
    <span class="n">major_step_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_max</span> <span class="o">-</span> <span class="n">x_min</span><span class="p">)</span> <span class="o">/</span> <span class="mi">5</span>
    <span class="n">major_step_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_max</span> <span class="o">-</span> <span class="n">y_min</span><span class="p">)</span> <span class="o">/</span> <span class="mi">5</span>
    <span class="n">major_step_x_rounded</span> <span class="o">=</span> <span class="n">round_nice</span><span class="p">(</span><span class="n">major_step_x</span><span class="p">)</span>
    <span class="n">major_step_y_rounded</span> <span class="o">=</span> <span class="n">round_nice</span><span class="p">(</span><span class="n">major_step_y</span><span class="p">)</span>
    <span class="c1"># Set the major and minor locators for the x-axis and y-axis</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="n">major_step_x_rounded</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="n">major_step_x_rounded</span> <span class="o">/</span> <span class="mi">5</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">set_y</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="n">major_step_y_rounded</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="n">major_step_y_rounded</span> <span class="o">/</span> <span class="mi">5</span><span class="p">))</span>
    <span class="c1"># Configure the appearance of major and minor ticks</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span> <span class="c1"># Adjust layout to prevent overlap between labels and the figure</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># Show the figure</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_ifc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_ifc</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function plots the current density as a function of time.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>variables</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Variables calculated by the solver. They correspond to the fuel cell internal states.</p>
              </div>
            </li>
            <li>
              <b><code>operating_inputs</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Operating inputs of the fuel cell.</p>
              </div>
            </li>
            <li>
              <b><code>parameters</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Parameters of the fuel cell model.</p>
              </div>
            </li>
            <li>
              <b><code>n</code></b>
                  (<code>int</code>)
              –
              <div class="doc-md-description">
                <p>Number of points used to plot the current density.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the current density will be plotted.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_ifc</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function plots the current density as a function of time.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variables : dict</span>
<span class="sd">        Variables calculated by the solver. They correspond to the fuel cell internal states.</span>
<span class="sd">    operating_inputs : dict</span>
<span class="sd">        Operating inputs of the fuel cell.</span>
<span class="sd">    parameters : dict</span>
<span class="sd">        Parameters of the fuel cell model.</span>
<span class="sd">    n : int</span>
<span class="sd">        Number of points used to plot the current density.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the current density will be plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extraction of the operating inputs and the parameters</span>
    <span class="n">current_density</span> <span class="o">=</span> <span class="n">operating_inputs</span><span class="p">[</span><span class="s1">&#39;current_density&#39;</span><span class="p">]</span>
    <span class="n">type_current</span><span class="p">,</span> <span class="n">type_plot</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_current&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_plot&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;step_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_step&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization_for_cali&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_for_cali_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola_cali&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Extraction of the variables</span>
    <span class="k">if</span> <span class="n">type_plot</span> <span class="o">==</span> <span class="s2">&quot;fixed&quot;</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">delta_t_ini</span>  <span class="c1"># select the time after 0.9*delta_t_ini</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># type_plot == &quot;dynamic&quot;</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>

    <span class="c1"># Plot the current density: ifc</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">ifc_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>  <span class="c1"># Creation of ifc_t</span>
        <span class="n">ifc_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_density</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">parameters</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e4</span>  <span class="c1"># Conversion in A/cm²</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ifc_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{i_</span><span class="si">{fc}</span><span class="s1">}$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Time}</span><span class="s1">$ $\mathbf</span><span class="si">{t}</span><span class="s1">$ $\mathbf{\left( s \right)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Current}</span><span class="s1">$ $\mathbf</span><span class="si">{density}</span><span class="s1">$ $\mathbf{i_</span><span class="si">{fc}</span><span class="s1">}$ $\mathbf{\left( A.cm^{-2} \right)}$&#39;</span><span class="p">,</span>
                  <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{i_</span><span class="si">{fc}</span><span class="s1">}$&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

    <span class="c1"># Plot instructions</span>
    <span class="n">plot_general_instructions</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_lambda" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_lambda</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function plots the water content at different spatial localisations, as a function of time.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>variables</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Variables calculated by the solver. They correspond to the fuel cell internal states.</p>
              </div>
            </li>
            <li>
              <b><code>operating_inputs</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Operating inputs of the fuel cell.</p>
              </div>
            </li>
            <li>
              <b><code>parameters</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Parameters of the fuel cell model.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the water content will be plotted.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_lambda</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function plots the water content at different spatial localisations, as a function of time.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variables : dict</span>
<span class="sd">        Variables calculated by the solver. They correspond to the fuel cell internal states.</span>
<span class="sd">    operating_inputs : dict</span>
<span class="sd">        Operating inputs of the fuel cell.</span>
<span class="sd">    parameters : dict</span>
<span class="sd">        Parameters of the fuel cell model.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the water content will be plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extraction of the operating inputs and the parameters</span>
    <span class="n">current_density</span> <span class="o">=</span> <span class="n">operating_inputs</span><span class="p">[</span><span class="s1">&#39;current_density&#39;</span><span class="p">]</span>
    <span class="n">pola_current_parameters</span><span class="p">,</span> <span class="n">type_current</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_parameters&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_current&#39;</span><span class="p">]</span>
    <span class="n">type_plot</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_plot&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;step_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_step&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization_for_cali&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_for_cali_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola_cali&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Extraction of the variables</span>
    <span class="k">if</span> <span class="n">type_plot</span> <span class="o">==</span> <span class="s2">&quot;fixed&quot;</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">delta_t_ini</span>  <span class="c1"># select the time after 0.9*delta_t_ini</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># type_plot == &quot;dynamic&quot;</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">lambda_acl_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lambda_acl&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">lambda_mem_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lambda_mem&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">lambda_ccl_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lambda_ccl&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>

    <span class="c1"># Plot the water content at different spatial localisations: lambda</span>
    <span class="k">if</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s2">&quot;polarization&quot;</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">ifc_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>  <span class="c1"># Creation of i_fc</span>
            <span class="n">ifc_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_density</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">parameters</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e4</span>  <span class="c1"># Conversion in A/cm²</span>
        <span class="c1"># Recovery of the internal states from the model after each stack stabilisation</span>
        <span class="n">delta_t_ini_pola</span> <span class="o">=</span> <span class="n">pola_current_parameters</span><span class="p">[</span><span class="s1">&#39;delta_t_ini_pola&#39;</span><span class="p">]</span>
        <span class="n">delta_t_load_pola</span> <span class="o">=</span> <span class="n">pola_current_parameters</span><span class="p">[</span><span class="s1">&#39;delta_t_load_pola&#39;</span><span class="p">]</span>
        <span class="n">delta_t_break_pola</span> <span class="o">=</span> <span class="n">pola_current_parameters</span><span class="p">[</span><span class="s1">&#39;delta_t_break_pola&#39;</span><span class="p">]</span>
        <span class="n">nb_loads</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pola_current_parameters</span><span class="p">[</span><span class="s1">&#39;i_max_pola&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">pola_current_parameters</span><span class="p">[</span><span class="s1">&#39;delta_i_pola&#39;</span><span class="p">])</span>  <span class="c1"># Number of loads which are made</span>
        <span class="n">ifc_discretized_t</span><span class="p">,</span> <span class="n">lambda_acl_discretized_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nb_loads</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nb_loads</span><span class="p">)</span>
        <span class="n">lambda_mem_discretized_t</span><span class="p">,</span> <span class="n">lambda_ccl_discretized_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nb_loads</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nb_loads</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_loads</span><span class="p">):</span>
            <span class="n">t_load</span> <span class="o">=</span> <span class="n">delta_t_ini_pola</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">delta_t_load_pola</span> <span class="o">+</span> <span class="n">delta_t_break_pola</span><span class="p">)</span>  <span class="c1"># time for measurement</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">t_load</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>  <span class="c1"># the corresponding index</span>
            <span class="n">ifc_discretized_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ifc_t</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>  <span class="c1"># the last value at the end of each load</span>
            <span class="n">lambda_acl_discretized_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lambda_acl_t</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>  <span class="c1"># the last value at the end of each load</span>
            <span class="n">lambda_mem_discretized_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lambda_mem_t</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>  <span class="c1"># the last value at the end of each load</span>
            <span class="n">lambda_ccl_discretized_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lambda_ccl_t</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>  <span class="c1"># the last value at the end of each load</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ifc_discretized_t</span><span class="p">,</span> <span class="n">lambda_acl_discretized_t</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ifc_discretized_t</span><span class="p">,</span> <span class="n">lambda_mem_discretized_t</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ifc_discretized_t</span><span class="p">,</span> <span class="n">lambda_ccl_discretized_t</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Current}</span><span class="s1">$ $\mathbf</span><span class="si">{density}</span><span class="s1">$ $\mathbf{i_</span><span class="si">{fc}</span><span class="s1">}$ $\mathbf{\left( A.cm^{-2} \right)}$&#39;</span><span class="p">,</span>
                      <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">lambda_acl_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">lambda_mem_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">lambda_ccl_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Time}</span><span class="s1">$ $\mathbf</span><span class="si">{t}</span><span class="s1">$ $\mathbf{\left( s \right)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Water}</span><span class="s1">$ $\mathbf</span><span class="si">{content}</span><span class="s1">$ $\mathbf{\lambda}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{\lambda_</span><span class="si">{acl}</span><span class="s1">}$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathregular{\lambda_</span><span class="si">{mem}</span><span class="s1">}$&#39;</span><span class="p">,</span>
               <span class="sa">r</span><span class="s1">&#39;$\mathregular{\lambda_</span><span class="si">{ccl}</span><span class="s1">}$&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

    <span class="c1"># Plot instructions</span>
    <span class="n">plot_general_instructions</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_pola_instructions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_pola_instructions</span><span class="p">(</span><span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function adds the specific instructions for polarisation plots according to the type_input to the ax object.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>type_fuel_cell</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Type of fuel cell configuration.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the instructions will be added.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_pola_instructions</span><span class="p">(</span><span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function adds the specific instructions for polarisation plots according to the type_input to the ax object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    type_fuel_cell : str</span>
<span class="sd">        Type of fuel cell configuration.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the instructions will be added.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># For EH-31 fuel cell</span>
    <span class="k">if</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_1.5&quot;</span> <span class="ow">or</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.0&quot;</span> <span class="ow">or</span> \
            <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.25&quot;</span> <span class="ow">or</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.5&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">0.5</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">/</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">0.1</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">/</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.04</span><span class="p">)</span>

    <span class="c1"># For LF fuel cell</span>
    <span class="k">elif</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;LF&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">0.4</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">0.4</span> <span class="o">/</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">0.2</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">0.2</span> <span class="o">/</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="c1"># For other fuel cell</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="c1"># Configure the appearance of major and minor ticks</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># Adjust layout to prevent overlap between labels and the figure</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># Show the figure</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_polarisation_curve" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_polarisation_curve</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function plots the model polarisation curve, and compare it to the experimental one (if it exists). The
polarisation curve is a classical representation of the cell performances, showing the cell voltage as a function
of the current density.
To generate it, the current density is increased step by step, and the cell voltage is recorded at each step.
The time for which this point is captured is determined using the following approach: at the beginning of each load,
a delta_t_load_pola time is needed to raise the current density to its next value. Subsequently, a delta_t_break_pola
time is observed to ensure the dynamic stability of the stack's variables before initiating a new load. Finally,
each polarisation point is recorded at the end of each delta_t_break_pola time.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>variables</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Variables calculated by the solver. They correspond to the fuel cell internal states.</p>
              </div>
            </li>
            <li>
              <b><code>operating_inputs</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Operating inputs of the fuel cell.</p>
              </div>
            </li>
            <li>
              <b><code>parameters</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Parameters of the fuel cell model.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the polarisation curve will be plotted.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_polarisation_curve</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function plots the model polarisation curve, and compare it to the experimental one (if it exists). The</span>
<span class="sd">    polarisation curve is a classical representation of the cell performances, showing the cell voltage as a function</span>
<span class="sd">    of the current density.</span>
<span class="sd">    To generate it, the current density is increased step by step, and the cell voltage is recorded at each step.</span>
<span class="sd">    The time for which this point is captured is determined using the following approach: at the beginning of each load,</span>
<span class="sd">    a delta_t_load_pola time is needed to raise the current density to its next value. Subsequently, a delta_t_break_pola</span>
<span class="sd">    time is observed to ensure the dynamic stability of the stack&#39;s variables before initiating a new load. Finally,</span>
<span class="sd">    each polarisation point is recorded at the end of each delta_t_break_pola time.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variables : dict</span>
<span class="sd">        Variables calculated by the solver. They correspond to the fuel cell internal states.</span>
<span class="sd">    operating_inputs : dict</span>
<span class="sd">        Operating inputs of the fuel cell.</span>
<span class="sd">    parameters : dict</span>
<span class="sd">        Parameters of the fuel cell model.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the polarisation curve will be plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extraction of the variables</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">Ucell_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Ucell&#39;</span><span class="p">])</span>
    <span class="c1"># Extraction of the operating inputs and the parameters</span>
    <span class="n">current_density</span> <span class="o">=</span> <span class="n">operating_inputs</span><span class="p">[</span><span class="s1">&#39;current_density&#39;</span><span class="p">]</span>
    <span class="n">pola_current_parameters</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_parameters&#39;</span><span class="p">]</span>
    <span class="n">delta_t_ini_pola</span> <span class="o">=</span> <span class="n">pola_current_parameters</span><span class="p">[</span><span class="s1">&#39;delta_t_ini_pola&#39;</span><span class="p">]</span>
    <span class="n">delta_t_load_pola</span> <span class="o">=</span> <span class="n">pola_current_parameters</span><span class="p">[</span><span class="s1">&#39;delta_t_load_pola&#39;</span><span class="p">]</span>
    <span class="n">delta_t_break_pola</span> <span class="o">=</span> <span class="n">pola_current_parameters</span><span class="p">[</span><span class="s1">&#39;delta_t_break_pola&#39;</span><span class="p">]</span>
    <span class="n">delta_i_pola</span><span class="p">,</span> <span class="n">i_max_pola</span> <span class="o">=</span> <span class="n">pola_current_parameters</span><span class="p">[</span><span class="s1">&#39;delta_i_pola&#39;</span><span class="p">],</span> <span class="n">pola_current_parameters</span><span class="p">[</span><span class="s1">&#39;i_max_pola&#39;</span><span class="p">]</span>
    <span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">type_current</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_fuel_cell&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_current&#39;</span><span class="p">]</span>
    <span class="n">type_auxiliary</span><span class="p">,</span> <span class="n">type_control</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_auxiliary&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_control&#39;</span><span class="p">]</span>
    <span class="n">type_plot</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_plot&#39;</span><span class="p">]</span>
    <span class="c1"># Extraction of the experimental current density and voltage values.</span>
    <span class="n">i_exp_t</span><span class="p">,</span> <span class="n">U_exp_t</span> <span class="o">=</span> <span class="n">pola_exp_values</span><span class="p">(</span><span class="n">type_fuel_cell</span><span class="p">)</span>  <span class="c1"># (A.m-2, V).</span>

    <span class="k">if</span> <span class="n">type_plot</span> <span class="o">==</span> <span class="s2">&quot;fixed&quot;</span><span class="p">:</span>
        <span class="c1"># Creation of ifc_t</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">ifc_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">ifc_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_density</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">parameters</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e4</span>  <span class="c1"># Conversion in A/cm²</span>

        <span class="c1"># Recovery of ifc and Ucell from the model after each stack stabilisation</span>
        <span class="n">nb_loads</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i_max_pola</span> <span class="o">/</span> <span class="n">delta_i_pola</span><span class="p">)</span>  <span class="c1"># Number of loads which are made</span>
        <span class="n">ifc_discretized</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nb_loads</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># One point is taken at ifc = 0, before the first load.</span>
        <span class="n">Ucell_discretized</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nb_loads</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># One point is taken at ifc = 0, before the first load.</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_loads</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">t_load</span> <span class="o">=</span> <span class="n">delta_t_ini_pola</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="n">delta_t_load_pola</span> <span class="o">+</span> <span class="n">delta_t_break_pola</span><span class="p">)</span> <span class="c1"># time for measurement</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">t_load</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>  <span class="c1"># the corresponding index</span>
            <span class="n">ifc_discretized</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ifc_t</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>  <span class="c1"># the last value at the end of each load</span>
            <span class="n">Ucell_discretized</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ucell_t</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>  <span class="c1"># the last value at the end of each load</span>

        <span class="c1"># Plot the experimental polarization curve and calculate the simulation error compared with experimental data</span>
        <span class="k">if</span> <span class="n">type_fuel_cell</span> <span class="o">!=</span> <span class="s2">&quot;manual_setup&quot;</span> <span class="ow">and</span> \
           <span class="n">type_auxiliary</span> <span class="o">==</span> <span class="s2">&quot;forced-convective_cathode_with_flow-through_anode&quot;</span><span class="p">:</span>  <span class="c1"># Experimental points are accessible</span>
            <span class="c1"># Plot of the experimental polarization curve</span>
            <span class="n">i_exp_t</span> <span class="o">=</span> <span class="n">i_exp_t</span> <span class="o">/</span> <span class="mf">1e4</span>  <span class="c1"># Conversion in A/cm²</span>
            <span class="n">plot_experimental_polarisation_curve</span><span class="p">(</span><span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">i_exp_t</span><span class="p">,</span> <span class="n">U_exp_t</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
            <span class="c1"># Calculate the simulation error compared with experimental data</span>
            <span class="c1">#       Experimental points are interpolated to correspond to the model points</span>
            <span class="n">Ucell_interpolated</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">ifc_discretized</span><span class="p">,</span> <span class="n">Ucell_discretized</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)(</span><span class="n">i_exp_t</span><span class="p">)</span>
            <span class="n">sim_error</span> <span class="o">=</span> <span class="n">calculate_simulation_error</span><span class="p">(</span><span class="n">Ucell_interpolated</span><span class="p">,</span> <span class="n">U_exp_t</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sim_error</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Plot the model polarisation curve</span>
        <span class="n">plot_specific_line</span><span class="p">(</span><span class="n">ifc_discretized</span><span class="p">,</span> <span class="n">Ucell_discretized</span><span class="p">,</span> <span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">type_current</span><span class="p">,</span> <span class="n">type_auxiliary</span><span class="p">,</span>
                           <span class="n">type_control</span><span class="p">,</span> <span class="n">sim_error</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
        <span class="n">plot_pola_instructions</span><span class="p">(</span><span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>  <span class="c1"># type_plot == &quot;dynamic&quot;</span>
        <span class="c1"># Plot of the polarisation curve produced by the model</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>  <span class="c1"># index for polarisation measurement</span>
        <span class="n">ifc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">current_density</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">parameters</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e4</span><span class="p">)</span>  <span class="c1"># time for polarisation measurement</span>
        <span class="n">Ucell</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Ucell_t</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>  <span class="c1"># voltage measurement</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ifc</span><span class="p">,</span> <span class="n">Ucell</span><span class="p">,</span> <span class="s1">&#39;og&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Add the common instructions for the plot</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Current}</span><span class="s1">$ $\mathbf</span><span class="si">{density}</span><span class="s1">$ $\mathbf{i_</span><span class="si">{fc}</span><span class="s1">}$ $\mathbf{\left( A.cm^{-2} \right)}$&#39;</span><span class="p">,</span>
                  <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Cell}</span><span class="s1">$ $\mathbf</span><span class="si">{voltage}</span><span class="s1">$ $\mathbf{U_</span><span class="si">{cell}</span><span class="s1">}$ $\mathbf{\left( V \right)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">type_plot</span> <span class="o">==</span> <span class="s2">&quot;fixed&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_polarisation_curve_for_cali" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_polarisation_curve_for_cali</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function plots the model polarisation curve, and compare it to the experimental one. The
polarisation curve is a classical representation of the cell performances, showing the cell voltage as a function
of the current density.
To generate it, the current density is increased step by step, and the cell voltage is recorded at each step.
The time for which this point is captured is determined using the following approach: at the beginning of each load,
a delta_t_load_pola time is needed to raise the current density to its next value. Subsequently, a delta_t_break_pola
time is observed to ensure the dynamic stability of the stack's variables before initiating a new load. Finally,
each polarisation point is recorded at the end of each delta_t_break_pola time.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>variables</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Variables calculated by the solver. They correspond to the fuel cell internal states.</p>
              </div>
            </li>
            <li>
              <b><code>operating_inputs</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Operating inputs of the fuel cell.</p>
              </div>
            </li>
            <li>
              <b><code>parameters</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Parameters of the fuel cell model.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the polarisation curve will be plotted.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_polarisation_curve_for_cali</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function plots the model polarisation curve, and compare it to the experimental one. The</span>
<span class="sd">    polarisation curve is a classical representation of the cell performances, showing the cell voltage as a function</span>
<span class="sd">    of the current density.</span>
<span class="sd">    To generate it, the current density is increased step by step, and the cell voltage is recorded at each step.</span>
<span class="sd">    The time for which this point is captured is determined using the following approach: at the beginning of each load,</span>
<span class="sd">    a delta_t_load_pola time is needed to raise the current density to its next value. Subsequently, a delta_t_break_pola</span>
<span class="sd">    time is observed to ensure the dynamic stability of the stack&#39;s variables before initiating a new load. Finally,</span>
<span class="sd">    each polarisation point is recorded at the end of each delta_t_break_pola time.</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variables : dict</span>
<span class="sd">        Variables calculated by the solver. They correspond to the fuel cell internal states.</span>
<span class="sd">    operating_inputs : dict</span>
<span class="sd">        Operating inputs of the fuel cell.</span>
<span class="sd">    parameters : dict</span>
<span class="sd">        Parameters of the fuel cell model.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the polarisation curve will be plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extraction of the variables</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">Ucell_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Ucell&#39;</span><span class="p">])</span>
    <span class="c1"># Extraction of the operating inputs and the parameters</span>
    <span class="n">current_density</span> <span class="o">=</span> <span class="n">operating_inputs</span><span class="p">[</span><span class="s1">&#39;current_density&#39;</span><span class="p">]</span>
    <span class="n">pola_current_for_cali_parameters</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_for_cali_parameters&#39;</span><span class="p">]</span>
    <span class="n">delta_t_ini_pola_cali</span> <span class="o">=</span> <span class="n">pola_current_for_cali_parameters</span><span class="p">[</span><span class="s1">&#39;delta_t_ini_pola_cali&#39;</span><span class="p">]</span>
    <span class="n">delta_t_load_pola_cali</span> <span class="o">=</span> <span class="n">pola_current_for_cali_parameters</span><span class="p">[</span><span class="s1">&#39;delta_t_load_pola_cali&#39;</span><span class="p">]</span>
    <span class="n">delta_t_break_pola_cali</span> <span class="o">=</span> <span class="n">pola_current_for_cali_parameters</span><span class="p">[</span><span class="s1">&#39;delta_t_break_pola_cali&#39;</span><span class="p">]</span>
    <span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">type_current</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_fuel_cell&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_current&#39;</span><span class="p">]</span>
    <span class="n">type_auxiliary</span><span class="p">,</span> <span class="n">type_control</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_auxiliary&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_control&#39;</span><span class="p">]</span>
    <span class="n">type_plot</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_plot&#39;</span><span class="p">]</span>
    <span class="c1"># Extraction of the experimental current density and voltage values for the calibration.</span>
    <span class="n">i_exp_cali_t</span><span class="p">,</span> <span class="n">U_exp_cali_t</span> <span class="o">=</span> <span class="n">pola_exp_values_calibration</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_fuel_cell&#39;</span><span class="p">])</span>  <span class="c1"># (A.m-2, V).</span>

    <span class="c1"># Creation of ifc_t</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">ifc_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">ifc_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_density</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">parameters</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e4</span>  <span class="c1"># Conversion in A/cm²</span>

    <span class="c1"># Recovery of ifc and Ucell from the model after each stack stabilisation</span>
    <span class="n">nb_loads</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">i_exp_cali_t</span><span class="p">)</span>  <span class="c1"># Number of loads which are made</span>
    <span class="n">delta_t_cali</span> <span class="o">=</span> <span class="n">delta_t_load_pola_cali</span> <span class="o">+</span> <span class="n">delta_t_break_pola_cali</span>  <span class="c1"># s. It is the time of one load.</span>
    <span class="n">ifc_discretized</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nb_loads</span><span class="p">)</span>
    <span class="n">Ucell_discretized</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nb_loads</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_loads</span><span class="p">):</span>
        <span class="n">t_load</span> <span class="o">=</span> <span class="n">delta_t_ini_pola_cali</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">delta_t_cali</span> <span class="c1"># time for measurement</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">t_load</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>  <span class="c1"># the corresponding index</span>
        <span class="n">ifc_discretized</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ifc_t</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>  <span class="c1"># the last value at the end of each load</span>
        <span class="n">Ucell_discretized</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ucell_t</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>  <span class="c1"># the last value at the end of each load</span>

    <span class="c1"># Plot the experimental polarization curve</span>
    <span class="n">i_exp_cali_t</span> <span class="o">=</span> <span class="n">i_exp_cali_t</span> <span class="o">/</span> <span class="mf">1e4</span>  <span class="c1"># Conversion in A/cm²</span>
    <span class="n">plot_experimental_polarisation_curve</span><span class="p">(</span><span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">i_exp_cali_t</span><span class="p">,</span> <span class="n">U_exp_cali_t</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>

    <span class="c1"># Plot the model polarisation curve</span>
    <span class="n">sim_error</span> <span class="o">=</span> <span class="n">calculate_simulation_error</span><span class="p">(</span><span class="n">Ucell_discretized</span><span class="p">,</span> <span class="n">U_exp_cali_t</span><span class="p">)</span> <span class="c1"># Calculate the simulation error</span>
    <span class="n">plot_specific_line</span><span class="p">(</span><span class="n">ifc_discretized</span><span class="p">,</span> <span class="n">Ucell_discretized</span><span class="p">,</span> <span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">type_current</span><span class="p">,</span> <span class="n">type_auxiliary</span><span class="p">,</span>
                       <span class="n">type_control</span><span class="p">,</span> <span class="n">sim_error</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
    <span class="n">plot_pola_instructions</span><span class="p">(</span><span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>

    <span class="c1"># Add the common instructions for the plot</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Current}</span><span class="s1">$ $\mathbf</span><span class="si">{density}</span><span class="s1">$ $\mathbf{i_</span><span class="si">{fc}</span><span class="s1">}$ $\mathbf{\left( A.cm^{-2} \right)}$&#39;</span><span class="p">,</span>
                  <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Cell}</span><span class="s1">$ $\mathbf</span><span class="si">{voltage}</span><span class="s1">$ $\mathbf{U_</span><span class="si">{cell}</span><span class="s1">}$ $\mathbf{\left( V \right)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">type_plot</span> <span class="o">==</span> <span class="s2">&quot;fixed&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_power_density_curve" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_power_density_curve</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function plots the power density curve Pfc, produced by a cell, as a function of the current density.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>variables</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Variables calculated by the solver. They correspond to the fuel cell internal states.</p>
              </div>
            </li>
            <li>
              <b><code>operating_inputs</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Operating inputs of the fuel cell.</p>
              </div>
            </li>
            <li>
              <b><code>parameters</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Parameters of the fuel cell model.</p>
              </div>
            </li>
            <li>
              <b><code>n</code></b>
                  (<code>int</code>)
              –
              <div class="doc-md-description">
                <p>Number of points used to plot the power density curve.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the power density curve will be plotted.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_power_density_curve</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function plots the power density curve Pfc, produced by a cell, as a function of the current density.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variables : dict</span>
<span class="sd">        Variables calculated by the solver. They correspond to the fuel cell internal states.</span>
<span class="sd">    operating_inputs : dict</span>
<span class="sd">        Operating inputs of the fuel cell.</span>
<span class="sd">    parameters : dict</span>
<span class="sd">        Parameters of the fuel cell model.</span>
<span class="sd">    n : int</span>
<span class="sd">        Number of points used to plot the power density curve.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the power density curve will be plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extraction of the variables</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">Ucell_t</span> <span class="o">=</span> <span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Ucell&#39;</span><span class="p">]</span>
    <span class="c1"># Extraction of the operating inputs and the parameters</span>
    <span class="n">current_density</span> <span class="o">=</span> <span class="n">operating_inputs</span><span class="p">[</span><span class="s1">&#39;current_density&#39;</span><span class="p">]</span>
    <span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">type_current</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_fuel_cell&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_current&#39;</span><span class="p">]</span>
    <span class="n">type_auxiliary</span><span class="p">,</span> <span class="n">type_control</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_auxiliary&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_control&#39;</span><span class="p">]</span>

    <span class="c1"># Creation of the power density function: Pfc</span>
    <span class="n">ifc_t</span><span class="p">,</span> <span class="n">Pfc_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">ifc_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_density</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">parameters</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e4</span>  <span class="c1"># Conversion in A/cm²</span>
        <span class="n">Pfc_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ucell_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">ifc_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="c1"># Plot of the power density function: Pfc</span>
    <span class="n">plot_specific_line</span><span class="p">(</span><span class="n">ifc_t</span><span class="p">,</span> <span class="n">Pfc_t</span><span class="p">,</span> <span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">type_current</span><span class="p">,</span> <span class="n">type_auxiliary</span><span class="p">,</span> <span class="n">type_control</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Current}</span><span class="s1">$ $\mathbf</span><span class="si">{density}</span><span class="s1">$ $\mathbf{i_</span><span class="si">{fc}</span><span class="s1">}$ $\mathbf{\left( A.cm^{-2} \right)}$&#39;</span><span class="p">,</span>
                  <span class="n">labelpad</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Fuel}</span><span class="s1">$ $\mathbf</span><span class="si">{cell}</span><span class="s1">$ $\mathbf</span><span class="si">{power}</span><span class="s1">$ $\mathbf</span><span class="si">{density}</span><span class="s1">$ $\mathbf{P_</span><span class="si">{fc}</span><span class="s1">}$ $\mathbf{\left( W.cm^{-2} \right)}$&#39;</span><span class="p">,</span>
                  <span class="n">labelpad</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

    <span class="c1"># Plot instructions</span>
    <span class="n">plot_general_instructions</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_s" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_s</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function plots the liquid water saturation at different spatial localisations, as a function of time.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>variables</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Variables calculated by the solver. They correspond to the fuel cell internal states.</p>
              </div>
            </li>
            <li>
              <b><code>operating_inputs</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Operating inputs of the fuel cell.</p>
              </div>
            </li>
            <li>
              <b><code>parameters</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>Parameters of the fuel cell model.</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the liquid water saturation will be plotted.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_s</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">operating_inputs</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function plots the liquid water saturation at different spatial localisations, as a function of time.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variables : dict</span>
<span class="sd">        Variables calculated by the solver. They correspond to the fuel cell internal states.</span>
<span class="sd">    operating_inputs : dict</span>
<span class="sd">        Operating inputs of the fuel cell.</span>
<span class="sd">    parameters : dict</span>
<span class="sd">        Parameters of the fuel cell model.</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the liquid water saturation will be plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extraction of the operating inputs and the parameters</span>
    <span class="n">current_density</span> <span class="o">=</span> <span class="n">operating_inputs</span><span class="p">[</span><span class="s1">&#39;current_density&#39;</span><span class="p">]</span>
    <span class="n">n_gdl</span><span class="p">,</span> <span class="n">pola_current_parameters</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;n_gdl&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_parameters&#39;</span><span class="p">]</span>
    <span class="n">type_current</span><span class="p">,</span> <span class="n">type_plot</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_current&#39;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;type_plot&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;step_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_step&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s1">&#39;polarization_for_cali&#39;</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;pola_current_for_cali_parameters&#39;</span><span class="p">][</span><span class="s1">&#39;delta_t_ini_pola_cali&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">delta_t_ini</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Extraction of the variables</span>
    <span class="k">if</span> <span class="n">type_plot</span> <span class="o">==</span> <span class="s2">&quot;fixed&quot;</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">delta_t_ini</span>  <span class="c1"># select the time after 0.9*delta_t_ini</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># type_plot == &quot;dynamic&quot;</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">s_agdl_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;s_agdl_</span><span class="si">{</span><span class="n">n_gdl</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">s_acl_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;s_acl&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">s_ccl_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;s_ccl&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">s_cgdl_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;s_cgdl_</span><span class="si">{</span><span class="n">n_gdl</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])[</span><span class="n">mask</span><span class="p">]</span>

    <span class="c1"># Plot the liquid water saturation at different spatial localisations: s</span>
    <span class="k">if</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s2">&quot;polarization&quot;</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">ifc_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>  <span class="c1"># Creation of i_fc</span>
            <span class="n">ifc_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_density</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">parameters</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e4</span>  <span class="c1"># Conversion in A/cm²</span>
        <span class="c1"># Recovery of the internal states from the model after each stack stabilisation</span>
        <span class="n">delta_t_ini_pola</span> <span class="o">=</span> <span class="n">pola_current_parameters</span><span class="p">[</span><span class="s1">&#39;delta_t_ini_pola&#39;</span><span class="p">]</span>
        <span class="n">delta_t_load_pola</span> <span class="o">=</span> <span class="n">pola_current_parameters</span><span class="p">[</span><span class="s1">&#39;delta_t_load_pola&#39;</span><span class="p">]</span>
        <span class="n">delta_t_break_pola</span> <span class="o">=</span> <span class="n">pola_current_parameters</span><span class="p">[</span><span class="s1">&#39;delta_t_break_pola&#39;</span><span class="p">]</span>
        <span class="n">nb_loads</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pola_current_parameters</span><span class="p">[</span><span class="s1">&#39;i_max_pola&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">pola_current_parameters</span><span class="p">[</span><span class="s1">&#39;delta_i_pola&#39;</span><span class="p">])</span> <span class="c1"># Number of loads</span>
        <span class="n">ifc_discretized_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nb_loads</span><span class="p">)</span>
        <span class="n">s_agdl_discretized_t</span><span class="p">,</span> <span class="n">s_acl_discretized_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nb_loads</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nb_loads</span><span class="p">)</span>
        <span class="n">s_ccl_discretized_t</span><span class="p">,</span> <span class="n">s_cgdl_discretized_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nb_loads</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nb_loads</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_loads</span><span class="p">):</span>
            <span class="n">t_load</span> <span class="o">=</span> <span class="n">delta_t_ini_pola</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">delta_t_load_pola</span> <span class="o">+</span> <span class="n">delta_t_break_pola</span><span class="p">)</span>  <span class="c1"># time for measurement</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">t_load</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>  <span class="c1"># the corresponding index</span>
            <span class="n">ifc_discretized_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ifc_t</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>  <span class="c1"># the last value at the end of each load</span>
            <span class="n">s_agdl_discretized_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s_agdl_t</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>  <span class="c1"># the last value at the end of each load</span>
            <span class="n">s_acl_discretized_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s_acl_t</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>  <span class="c1"># the last value at the end of each load</span>
            <span class="n">s_ccl_discretized_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s_ccl_t</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>  <span class="c1"># the last value at the end of each load</span>
            <span class="n">s_cgdl_discretized_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span><span class="n">s_cgdl_t</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>  <span class="c1"># the last value at the end of each load</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ifc_discretized_t</span><span class="p">,</span> <span class="n">s_agdl_discretized_t</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ifc_discretized_t</span><span class="p">,</span> <span class="n">s_acl_discretized_t</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ifc_discretized_t</span><span class="p">,</span> <span class="n">s_ccl_discretized_t</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ifc_discretized_t</span><span class="p">,</span> <span class="n">s_cgdl_discretized_t</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Current}</span><span class="s1">$ $\mathbf</span><span class="si">{density}</span><span class="s1">$ $\mathbf{i_</span><span class="si">{fc}</span><span class="s1">}$ $\mathbf{\left( A.cm^{-2} \right)}$&#39;</span><span class="p">,</span>
                      <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s_agdl_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s_acl_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s_ccl_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s_cgdl_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Time}</span><span class="s1">$ $\mathbf</span><span class="si">{t}</span><span class="s1">$ $\mathbf{\left( s \right)}$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{Liquid}</span><span class="s1">$ $\mathbf</span><span class="si">{water}</span><span class="s1">$ $\mathbf</span><span class="si">{saturation}</span><span class="s1">$ $\mathbf</span><span class="si">{s}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$\mathregular{s_</span><span class="si">{agdl}</span><span class="s1">}$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathregular{s_</span><span class="si">{acl}</span><span class="s1">}$&#39;</span><span class="p">,</span>
               <span class="sa">r</span><span class="s1">&#39;$\mathregular{s_</span><span class="si">{ccl}</span><span class="s1">}$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mathregular{s_</span><span class="si">{cgdl}</span><span class="s1">}$&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

    <span class="c1"># Plot instructions</span>
    <span class="n">plot_general_instructions</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.plot_specific_line" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_specific_line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">type_current</span><span class="p">,</span> <span class="n">type_auxiliary</span><span class="p">,</span> <span class="n">type_control</span><span class="p">,</span> <span class="n">sim_error</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function adds the appropriate plot configuration according to the type_input to the ax object.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>x</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>x-axis values.</p>
              </div>
            </li>
            <li>
              <b><code>y</code></b>
                  (<code><span title="numpy.ndarray">ndarray</span></code>)
              –
              <div class="doc-md-description">
                <p>y-axis values.</p>
              </div>
            </li>
            <li>
              <b><code>type_fuel_cell</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Type of fuel cell configuration.</p>
              </div>
            </li>
            <li>
              <b><code>type_current</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Type of current density.</p>
              </div>
            </li>
            <li>
              <b><code>type_auxiliary</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Type of auxiliary system.</p>
              </div>
            </li>
            <li>
              <b><code>type_control</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Type of control system.</p>
              </div>
            </li>
            <li>
              <b><code>sim_error</code></b>
                  (<code>float</code>)
              –
              <div class="doc-md-description">
                <p>Simulation error between the simulated cell voltage and the experimental cell voltage (in %).</p>
              </div>
            </li>
            <li>
              <b><code>ax</code></b>
                  (<code><span title="matplotlib.axes.Axes">Axes</span></code>)
              –
              <div class="doc-md-description">
                <p>Axes on which the line will be plotted.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_specific_line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">type_fuel_cell</span><span class="p">,</span> <span class="n">type_current</span><span class="p">,</span> <span class="n">type_auxiliary</span><span class="p">,</span> <span class="n">type_control</span><span class="p">,</span> <span class="n">sim_error</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This function adds the appropriate plot configuration according to the type_input to the ax object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : numpy.ndarray</span>
<span class="sd">        x-axis values.</span>
<span class="sd">    y : numpy.ndarray</span>
<span class="sd">        y-axis values.</span>
<span class="sd">    type_fuel_cell : str</span>
<span class="sd">        Type of fuel cell configuration.</span>
<span class="sd">    type_current : str</span>
<span class="sd">        Type of current density.</span>
<span class="sd">    type_auxiliary : str</span>
<span class="sd">        Type of auxiliary system.</span>
<span class="sd">    type_control : str</span>
<span class="sd">        Type of control system.</span>
<span class="sd">    sim_error : float</span>
<span class="sd">        Simulation error between the simulated cell voltage and the experimental cell voltage (in %).</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axes on which the line will be plotted.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># For EH-31 fuel cell</span>
    <span class="k">if</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s2">&quot;polarization&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_1.5&quot;</span> <span class="ow">or</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.0&quot;</span> <span class="ow">or</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.25&quot;</span> <span class="ow">or</span> \
                <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.5&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_1.5&quot;</span> <span class="ow">and</span> <span class="n">type_auxiliary</span> <span class="o">==</span> <span class="s2">&quot;forced-convective_cathode_with_flow-through_anode&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sim. - P = 1.5 bar&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; - $ΔU_</span><span class="si">{max}</span><span class="s1">$ =&#39;</span> <span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">sim_error</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_1.5&quot;</span> <span class="ow">and</span> <span class="n">type_auxiliary</span> <span class="o">!=</span> <span class="s2">&quot;forced-convective_cathode_with_flow-through_anode&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sim. - P = 1.5 bar&#39;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.0&quot;</span> <span class="ow">and</span> <span class="n">type_auxiliary</span> <span class="o">==</span> <span class="s2">&quot;forced-convective_cathode_with_flow-through_anode&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sim. - P = 2.0 bar&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; - $ΔU_</span><span class="si">{max}</span><span class="s1">$ =&#39;</span> <span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">sim_error</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.0&quot;</span> <span class="ow">and</span> <span class="n">type_auxiliary</span> <span class="o">!=</span> <span class="s2">&quot;forced-convective_cathode_with_flow-through_anode&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">type_control</span> <span class="o">==</span> <span class="s2">&quot;Phi_des&quot;</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
                            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Sim. - P = 2.0 bar - controlled $\mathregular{\Phi_</span><span class="si">{des}</span><span class="s1">}$&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
                            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Sim. - P = 2.0 bar - uncontrolled $\mathregular{\Phi_</span><span class="si">{des}</span><span class="s1">}$&#39;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.25&quot;</span> <span class="ow">and</span> <span class="n">type_auxiliary</span> <span class="o">==</span> <span class="s2">&quot;forced-convective_cathode_with_flow-through_anode&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sim. - P = 2.25 bar&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; - $ΔU_</span><span class="si">{max}</span><span class="s1">$ =&#39;</span> <span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">sim_error</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.25&quot;</span> <span class="ow">and</span> <span class="n">type_auxiliary</span> <span class="o">!=</span> <span class="s2">&quot;forced-convective_cathode_with_flow-through_anode&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sim. - P = 2.25 bar&#39;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.5&quot;</span> <span class="ow">and</span> <span class="n">type_auxiliary</span> <span class="o">==</span> <span class="s2">&quot;forced-convective_cathode_with_flow-through_anode&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sim - P = 2.5 bar&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; - $ΔU_</span><span class="si">{max}</span><span class="s1">$ =&#39;</span> <span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">sim_error</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.5&quot;</span> <span class="ow">and</span> <span class="n">type_auxiliary</span> <span class="o">!=</span> <span class="s2">&quot;forced-convective_cathode_with_flow-through_anode&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sim - P = 2.5 bar&#39;</span><span class="p">)</span>

        <span class="c1"># For LF fuel cell</span>
        <span class="k">elif</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;LF&quot;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Simulation&#39;</span><span class="p">)</span>

        <span class="c1"># For other fuel cell</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Simulation&#39;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">type_current</span> <span class="o">==</span> <span class="s2">&quot;polarization_for_cali&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_1.5&quot;</span> <span class="ow">or</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.0&quot;</span> <span class="ow">or</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.25&quot;</span> <span class="ow">or</span> \
                <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.5&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_1.5&quot;</span> <span class="ow">and</span> <span class="n">type_auxiliary</span> <span class="o">==</span> <span class="s2">&quot;forced-convective_cathode_with_flow-through_anode&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sim. - P = 1.5 bar&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; - $ΔU_</span><span class="si">{max}</span><span class="s1">$ =&#39;</span> <span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">sim_error</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_1.5&quot;</span> <span class="ow">and</span> <span class="n">type_auxiliary</span> <span class="o">!=</span> <span class="s2">&quot;forced-convective_cathode_with_flow-through_anode&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sim. - P = 1.5 bar&#39;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.0&quot;</span> <span class="ow">and</span> <span class="n">type_auxiliary</span> <span class="o">==</span> <span class="s2">&quot;forced-convective_cathode_with_flow-through_anode&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sim. - P = 2.0 bar&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; - $ΔU_</span><span class="si">{max}</span><span class="s1">$ =&#39;</span> <span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">sim_error</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.0&quot;</span> <span class="ow">and</span> <span class="n">type_auxiliary</span> <span class="o">!=</span> <span class="s2">&quot;forced-convective_cathode_with_flow-through_anode&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">type_control</span> <span class="o">==</span> <span class="s2">&quot;Phi_des&quot;</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
                            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Sim. - P = 2.0 bar - controlled $\mathregular{\Phi_</span><span class="si">{des}</span><span class="s1">}$&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
                            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Sim. - P = 2.0 bar - uncontrolled $\mathregular{\Phi_</span><span class="si">{des}</span><span class="s1">}$&#39;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.25&quot;</span> <span class="ow">and</span> <span class="n">type_auxiliary</span> <span class="o">==</span> <span class="s2">&quot;forced-convective_cathode_with_flow-through_anode&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sim. - P = 2.25 bar&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; - $ΔU_</span><span class="si">{max}</span><span class="s1">$ =&#39;</span> <span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">sim_error</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.25&quot;</span> <span class="ow">and</span> <span class="n">type_auxiliary</span> <span class="o">!=</span> <span class="s2">&quot;forced-convective_cathode_with_flow-through_anode&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sim. - P = 2.25 bar&#39;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.5&quot;</span> <span class="ow">and</span> <span class="n">type_auxiliary</span> <span class="o">==</span> <span class="s2">&quot;forced-convective_cathode_with_flow-through_anode&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
                        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sim - P = 2.5 bar&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; - $ΔU_</span><span class="si">{max}</span><span class="s1">$ =&#39;</span> <span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">sim_error</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;EH-31_2.5&quot;</span> <span class="ow">and</span> <span class="n">type_auxiliary</span> <span class="o">!=</span> <span class="s2">&quot;forced-convective_cathode_with_flow-through_anode&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sim - P = 2.5 bar&#39;</span><span class="p">)</span>

        <span class="c1"># For LF fuel cell</span>
        <span class="k">elif</span> <span class="n">type_fuel_cell</span> <span class="o">==</span> <span class="s2">&quot;LF&quot;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Simulation&#39;</span><span class="p">)</span>

        <span class="c1"># For other fuel cell</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Simulation&#39;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Only &quot;polarization_current&quot; and &quot;polarization_current_for_cali&quot; are considered here.&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="modules.display_modules.round_nice" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">round_nice</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Round the main step to a "nice" number.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>x</code></b>
                  (<code>float</code>)
              –
              <div class="doc-md-description">
                <p>The value to be rounded.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>float</code>
              –
              <div class="doc-md-description">
                <p>The value rounded to a "nice" number.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>modules/display_modules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">round_nice</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Round the main step to a &quot;nice&quot; number.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : float</span>
<span class="sd">        The value to be rounded.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float</span>
<span class="sd">        The value rounded to a &quot;nice&quot; number.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="mi">10</span><span class="o">**</span><span class="n">exp</span>
    <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;</span> <span class="mf">1.5</span><span class="p">:</span>
        <span class="n">nice</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">f</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">nice</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">elif</span> <span class="n">f</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">:</span>
        <span class="n">nice</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nice</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="k">return</span> <span class="n">nice</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="n">exp</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../dif_eq_modules/" class="btn btn-neutral float-left" title="Differential equations modules"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../flows_modules/" class="btn btn-neutral float-right" title="Flows modules">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../dif_eq_modules/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../flows_modules/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
